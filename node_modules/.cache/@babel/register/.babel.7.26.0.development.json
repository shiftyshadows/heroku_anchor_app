{"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _cookieParser = _interopRequireDefault(require(\"cookie-parser\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nvar _auth = _interopRequireDefault(require(\"./routes/auth.js\"));\nvar _products = _interopRequireDefault(require(\"./routes/products.js\"));\nvar _url = require(\"url\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Initialize environment variables\n_dotenv.default.config();\nconst app = (0, _express.default)();\nconst PORT = process.env.PORT || 5000;\nconst NODE_ENV = process.env.NODE_ENV || \"development\";\n\n// Resolve __dirname for ES Modules\nconst _filename = (0, _url.fileURLToPath)(import.meta.url);\nconst _dirname = _path.default.dirname(_filename);\n\n// Middleware: Allow requests from the frontend origin\napp.use((0, _cors.default)({\n  origin: process.env.FRONTEND_URL,\n  // Frontend URL\n  credentials: true // Allow cookies and headers\n}));\n\n// Middleware: Parse JSON and Cookies\napp.use(_express.default.json());\napp.use((0, _cookieParser.default)());\n\n// API Routes\napp.use(\"/api/auth\", _auth.default); // Authentication routes\napp.use(\"/api/products\", _products.default); // Product routes\n\n// Serve static files for production\nif (NODE_ENV === \"production\") {\n  app.use(_express.default.static(_path.default.join(_dirname, \"client/build\")));\n\n  // Catch-all route to serve React app\n  app.get(\"*\", (req, res) => {\n    res.sendFile(_path.default.join(_dirname, \"client/build\", \"index.html\"));\n  });\n} else {\n  // Default route for non-production environments\n  app.get(\"/\", (req, res) => {\n    res.send(\"API is running...\");\n  });\n}\n\n// MongoDB Connection\n_mongoose.default.connect(process.env.MONGO_URI).then(() => {\n  console.log(\"‚úÖ Connected to MongoDB\");\n  app.listen(PORT, () => console.log(`üöÄ Server running on http://localhost:${PORT}`));\n}).catch(err => {\n  console.error(\"‚ùå MongoDB connection failed:\", err.message);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2RvdGVudiIsIl9tb25nb29zZSIsIl9wYXRoIiwiX2Nvb2tpZVBhcnNlciIsIl9jb3JzIiwiX2F1dGgiLCJfcHJvZHVjdHMiLCJfdXJsIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZG90ZW52IiwiY29uZmlnIiwiYXBwIiwiZXhwcmVzcyIsIlBPUlQiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJfX2ZpbGVuYW1lIiwiZmlsZVVSTFRvUGF0aCIsImltcG9ydCIsIm1ldGEiLCJ1cmwiLCJfX2Rpcm5hbWUiLCJwYXRoIiwiZGlybmFtZSIsInVzZSIsImNvcnMiLCJvcmlnaW4iLCJGUk9OVEVORF9VUkwiLCJjcmVkZW50aWFscyIsImpzb24iLCJjb29raWVQYXJzZXIiLCJhdXRoUm91dGVzIiwicHJvZHVjdFJvdXRlcyIsInN0YXRpYyIsImpvaW4iLCJnZXQiLCJyZXEiLCJyZXMiLCJzZW5kRmlsZSIsInNlbmQiLCJtb25nb29zZSIsImNvbm5lY3QiLCJNT05HT19VUkkiLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImxpc3RlbiIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy8iLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IGNvb2tpZVBhcnNlciBmcm9tIFwiY29va2llLXBhcnNlclwiO1xuaW1wb3J0IGNvcnMgZnJvbSBcImNvcnNcIjtcbmltcG9ydCBhdXRoUm91dGVzIGZyb20gXCIuL3JvdXRlcy9hdXRoLmpzXCI7XG5pbXBvcnQgcHJvZHVjdFJvdXRlcyBmcm9tIFwiLi9yb3V0ZXMvcHJvZHVjdHMuanNcIjtcbmltcG9ydCB7IGZpbGVVUkxUb1BhdGggfSBmcm9tIFwidXJsXCI7XG5cbi8vIEluaXRpYWxpemUgZW52aXJvbm1lbnQgdmFyaWFibGVzXG5kb3RlbnYuY29uZmlnKCk7XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDUwMDA7XG5jb25zdCBOT0RFX0VOViA9IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiZGV2ZWxvcG1lbnRcIjtcblxuLy8gUmVzb2x2ZSBfX2Rpcm5hbWUgZm9yIEVTIE1vZHVsZXNcbmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cbi8vIE1pZGRsZXdhcmU6IEFsbG93IHJlcXVlc3RzIGZyb20gdGhlIGZyb250ZW5kIG9yaWdpblxuYXBwLnVzZShcbiAgY29ycyh7XG4gICAgb3JpZ2luOiBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkwsIC8vIEZyb250ZW5kIFVSTFxuICAgIGNyZWRlbnRpYWxzOiB0cnVlLCAvLyBBbGxvdyBjb29raWVzIGFuZCBoZWFkZXJzXG4gIH0pXG4pO1xuXG4vLyBNaWRkbGV3YXJlOiBQYXJzZSBKU09OIGFuZCBDb29raWVzXG5hcHAudXNlKGV4cHJlc3MuanNvbigpKTtcbmFwcC51c2UoY29va2llUGFyc2VyKCkpO1xuXG4vLyBBUEkgUm91dGVzXG5hcHAudXNlKFwiL2FwaS9hdXRoXCIsIGF1dGhSb3V0ZXMpOyAvLyBBdXRoZW50aWNhdGlvbiByb3V0ZXNcbmFwcC51c2UoXCIvYXBpL3Byb2R1Y3RzXCIsIHByb2R1Y3RSb3V0ZXMpOyAvLyBQcm9kdWN0IHJvdXRlc1xuXG4vLyBTZXJ2ZSBzdGF0aWMgZmlsZXMgZm9yIHByb2R1Y3Rpb25cbmlmIChOT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcImNsaWVudC9idWlsZFwiKSkpO1xuXG4gIC8vIENhdGNoLWFsbCByb3V0ZSB0byBzZXJ2ZSBSZWFjdCBhcHBcbiAgYXBwLmdldChcIipcIiwgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmRGaWxlKHBhdGguam9pbihfX2Rpcm5hbWUsIFwiY2xpZW50L2J1aWxkXCIsIFwiaW5kZXguaHRtbFwiKSk7XG4gIH0pO1xufSBlbHNlIHtcbiAgLy8gRGVmYXVsdCByb3V0ZSBmb3Igbm9uLXByb2R1Y3Rpb24gZW52aXJvbm1lbnRzXG4gIGFwcC5nZXQoXCIvXCIsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKFwiQVBJIGlzIHJ1bm5pbmcuLi5cIik7XG4gIH0pO1xufVxuXG4vLyBNb25nb0RCIENvbm5lY3Rpb25cbm1vbmdvb3NlXG4gIC5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSSSlcbiAgLnRoZW4oKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKFwi4pyFIENvbm5lY3RlZCB0byBNb25nb0RCXCIpO1xuICAgIGFwcC5saXN0ZW4oUE9SVCwgKCkgPT5cbiAgICAgIGNvbnNvbGUubG9nKGDwn5qAIFNlcnZlciBydW5uaW5nIG9uIGh0dHA6Ly9sb2NhbGhvc3Q6JHtQT1JUfWApXG4gICAgKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIE1vbmdvREIgY29ubmVjdGlvbiBmYWlsZWQ6XCIsIGVyci5tZXNzYWdlKTtcbiAgfSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxP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","map":{"version":3,"names":["_express","_interopRequireDefault","require","_dotenv","_mongoose","_path","_cookieParser","_cors","_auth","_products","_url","e","__esModule","default","dotenv","config","app","express","PORT","process","env","NODE_ENV","__filename","fileURLToPath","import","meta","url","__dirname","path","dirname","use","cors","origin","FRONTEND_URL","credentials","json","cookieParser","authRoutes","productRoutes","static","join","get","req","res","sendFile","send","mongoose","connect","MONGO_URI","then","console","log","listen","catch","err","error","message"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/","sources":["server.js"],"sourcesContent":["import express from \"express\";\nimport dotenv from \"dotenv\";\nimport mongoose from \"mongoose\";\nimport path from \"path\";\nimport cookieParser from \"cookie-parser\";\nimport cors from \"cors\";\nimport authRoutes from \"./routes/auth.js\";\nimport productRoutes from \"./routes/products.js\";\nimport { fileURLToPath } from \"url\";\n\n// Initialize environment variables\ndotenv.config();\n\nconst app = express();\nconst PORT = process.env.PORT || 5000;\nconst NODE_ENV = process.env.NODE_ENV || \"development\";\n\n// Resolve __dirname for ES Modules\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Middleware: Allow requests from the frontend origin\napp.use(\n  cors({\n    origin: process.env.FRONTEND_URL, // Frontend URL\n    credentials: true, // Allow cookies and headers\n  })\n);\n\n// Middleware: Parse JSON and Cookies\napp.use(express.json());\napp.use(cookieParser());\n\n// API Routes\napp.use(\"/api/auth\", authRoutes); // Authentication routes\napp.use(\"/api/products\", productRoutes); // Product routes\n\n// Serve static files for production\nif (NODE_ENV === \"production\") {\n  app.use(express.static(path.join(__dirname, \"client/build\")));\n\n  // Catch-all route to serve React app\n  app.get(\"*\", (req, res) => {\n    res.sendFile(path.join(__dirname, \"client/build\", \"index.html\"));\n  });\n} else {\n  // Default route for non-production environments\n  app.get(\"/\", (req, res) => {\n    res.send(\"API is running...\");\n  });\n}\n\n// MongoDB Connection\nmongoose\n  .connect(process.env.MONGO_URI)\n  .then(() => {\n    console.log(\"‚úÖ Connected to MongoDB\");\n    app.listen(PORT, () =>\n      console.log(`üöÄ Server running on http://localhost:${PORT}`)\n    );\n  })\n  .catch((err) => {\n    console.error(\"‚ùå MongoDB connection failed:\", err.message);\n  });\n"],"mappings":";;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,SAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,KAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,aAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,KAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,KAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,SAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,IAAA,GAAAR,OAAA;AAAoC,SAAAD,uBAAAU,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEpC;AACAG,eAAM,CAACC,MAAM,CAAC,CAAC;AAEf,MAAMC,GAAG,GAAG,IAAAC,gBAAO,EAAC,CAAC;AACrB,MAAMC,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACF,IAAI,IAAI,IAAI;AACrC,MAAMG,QAAQ,GAAGF,OAAO,CAACC,GAAG,CAACC,QAAQ,IAAI,aAAa;;AAEtD;AACA,MAAMC,SAAU,GAAG,IAAAC,kBAAa,EAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAAC;AACjD,MAAMC,QAAS,GAAGC,aAAI,CAACC,OAAO,CAACP,SAAU,CAAC;;AAE1C;AACAN,GAAG,CAACc,GAAG,CACL,IAAAC,aAAI,EAAC;EACHC,MAAM,EAAEb,OAAO,CAACC,GAAG,CAACa,YAAY;EAAE;EAClCC,WAAW,EAAE,IAAI,CAAE;AACrB,CAAC,CACH,CAAC;;AAED;AACAlB,GAAG,CAACc,GAAG,CAACb,gBAAO,CAACkB,IAAI,CAAC,CAAC,CAAC;AACvBnB,GAAG,CAACc,GAAG,CAAC,IAAAM,qBAAY,EAAC,CAAC,CAAC;;AAEvB;AACApB,GAAG,CAACc,GAAG,CAAC,WAAW,EAAEO,aAAU,CAAC,CAAC,CAAC;AAClCrB,GAAG,CAACc,GAAG,CAAC,eAAe,EAAEQ,iBAAa,CAAC,CAAC,CAAC;;AAEzC;AACA,IAAIjB,QAAQ,KAAK,YAAY,EAAE;EAC7BL,GAAG,CAACc,GAAG,CAACb,gBAAO,CAACsB,MAAM,CAACX,aAAI,CAACY,IAAI,CAACb,QAAS,EAAE,cAAc,CAAC,CAAC,CAAC;;EAE7D;EACAX,GAAG,CAACyB,GAAG,CAAC,GAAG,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;IACzBA,GAAG,CAACC,QAAQ,CAAChB,aAAI,CAACY,IAAI,CAACb,QAAS,EAAE,cAAc,EAAE,YAAY,CAAC,CAAC;EAClE,CAAC,CAAC;AACJ,CAAC,MAAM;EACL;EACAX,GAAG,CAACyB,GAAG,CAAC,GAAG,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;IACzBA,GAAG,CAACE,IAAI,CAAC,mBAAmB,CAAC;EAC/B,CAAC,CAAC;AACJ;;AAEA;AACAC,iBAAQ,CACLC,OAAO,CAAC5B,OAAO,CAACC,GAAG,CAAC4B,SAAS,CAAC,CAC9BC,IAAI,CAAC,MAAM;EACVC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;EACrCnC,GAAG,CAACoC,MAAM,CAAClC,IAAI,EAAE,MACfgC,OAAO,CAACC,GAAG,CAAC,yCAAyCjC,IAAI,EAAE,CAC7D,CAAC;AACH,CAAC,CAAC,CACDmC,KAAK,CAAEC,GAAG,IAAK;EACdJ,OAAO,CAACK,KAAK,CAAC,8BAA8B,EAAED,GAAG,CAACE,OAAO,CAAC;AAC5D,CAAC,CAAC","ignoreList":[]}},"mtime":1737836590276},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _argon = _interopRequireDefault(require(\"argon2\"));\nvar _User = _interopRequireDefault(require(\"../models/User.js\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Replacing bcryptjs with argon2\n// Adjust the path based on your project structure\n\n_dotenv.default.config();\nconst router = _express.default.Router();\nconst SECRET_KEY = process.env.SECRET_KEY;\n\n// Signup route\nrouter.post(\"/signup\", async (req, res) => {\n  const {\n    email,\n    password,\n    username\n  } = req.body;\n  try {\n    // Validate input\n    if (!email || !password || !username) {\n      return res.status(400).json({\n        message: \"All fields are required.\"\n      });\n    }\n\n    // Check if the email already exists\n    const existingUserByEmail = await _User.default.findOne({\n      email\n    });\n    if (existingUserByEmail) {\n      return res.status(400).json({\n        message: \"Email already registered.\"\n      });\n    }\n\n    // Check if the username already exists\n    const existingUserByUsername = await _User.default.findOne({\n      username\n    });\n    if (existingUserByUsername) {\n      return res.status(400).json({\n        message: \"Username already taken.\"\n      });\n    }\n\n    // Hash the password using Argon2\n    const hashedPassword = await _argon.default.hash(password);\n\n    // Check if this is the first user and make them admin\n    const isFirstUser = (await _User.default.countDocuments()) === 0;\n\n    // Create the user\n    const newUser = new _User.default({\n      email,\n      password: hashedPassword,\n      username,\n      isAdmin: isFirstUser // Grant admin access to the first user\n    });\n    await newUser.save();\n\n    // Send response\n    res.status(201).json({\n      message: \"User registered successfully.\",\n      isAdmin: newUser.isAdmin\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      message: \"Server error. Please try again later.\"\n    });\n  }\n});\n\n// POST: /api/auth/signin\nrouter.post(\"/signin\", async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n  try {\n    // Check if user exists\n    const user = await _User.default.findOne({\n      email\n    });\n    if (!user) {\n      console.log(\"User not found with email:\", email);\n      return res.status(400).json({\n        message: \"Invalid email or password.\"\n      });\n    }\n\n    // Log the found user (to debug the issue)\n    console.log(\"User found:\", user);\n\n    // Verify password using Argon2\n    const isMatch = await _argon.default.verify(user.password, password);\n    if (!isMatch) {\n      console.log(\"Password mismatch for user:\", user.username);\n      return res.status(400).json({\n        message: \"Invalid email or password.\"\n      });\n    }\n\n    // Generate token\n    const token = _jsonwebtoken.default.sign({\n      id: user._id,\n      isAdmin: user.isAdmin\n    }, SECRET_KEY, {\n      expiresIn: \"1h\"\n    });\n\n    // Send token as a cookie\n    res.cookie(\"token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\" // Secure cookies in production\n    });\n\n    // Respond with user role\n    res.status(200).json({\n      isAdmin: user.isAdmin\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      message: \"Server error. Please try again later.\"\n    });\n  }\n});\nvar _default = exports.default = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2FyZ29uIiwiX1VzZXIiLCJfanNvbndlYnRva2VuIiwiX2RvdGVudiIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImRvdGVudiIsImNvbmZpZyIsInJvdXRlciIsImV4cHJlc3MiLCJSb3V0ZXIiLCJTRUNSRVRfS0VZIiwicHJvY2VzcyIsImVudiIsInBvc3QiLCJyZXEiLCJyZXMiLCJlbWFpbCIsInBhc3N3b3JkIiwidXNlcm5hbWUiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJleGlzdGluZ1VzZXJCeUVtYWlsIiwiVXNlciIsImZpbmRPbmUiLCJleGlzdGluZ1VzZXJCeVVzZXJuYW1lIiwiaGFzaGVkUGFzc3dvcmQiLCJhcmdvbjIiLCJoYXNoIiwiaXNGaXJzdFVzZXIiLCJjb3VudERvY3VtZW50cyIsIm5ld1VzZXIiLCJpc0FkbWluIiwic2F2ZSIsImVycm9yIiwiY29uc29sZSIsInVzZXIiLCJsb2ciLCJpc01hdGNoIiwidmVyaWZ5IiwidG9rZW4iLCJqd3QiLCJzaWduIiwiaWQiLCJfaWQiLCJleHBpcmVzSW4iLCJjb29raWUiLCJodHRwT25seSIsInNlY3VyZSIsIk5PREVfRU5WIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJhdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgYXJnb24yIGZyb20gXCJhcmdvbjJcIjsgIC8vIFJlcGxhY2luZyBiY3J5cHRqcyB3aXRoIGFyZ29uMlxuaW1wb3J0IFVzZXIgZnJvbSBcIi4uL21vZGVscy9Vc2VyLmpzXCI7IC8vIEFkanVzdCB0aGUgcGF0aCBiYXNlZCBvbiB5b3VyIHByb2plY3Qgc3RydWN0dXJlXG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xuXG5kb3RlbnYuY29uZmlnKCk7XG5cbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBTRUNSRVRfS0VZID0gcHJvY2Vzcy5lbnYuU0VDUkVUX0tFWTtcblxuLy8gU2lnbnVwIHJvdXRlXG5yb3V0ZXIucG9zdChcIi9zaWdudXBcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkLCB1c2VybmFtZSB9ID0gcmVxLmJvZHk7XG5cbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBpbnB1dFxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkIHx8ICF1c2VybmFtZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogXCJBbGwgZmllbGRzIGFyZSByZXF1aXJlZC5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgZW1haWwgYWxyZWFkeSBleGlzdHNcbiAgICBjb25zdCBleGlzdGluZ1VzZXJCeUVtYWlsID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgaWYgKGV4aXN0aW5nVXNlckJ5RW1haWwpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiRW1haWwgYWxyZWFkeSByZWdpc3RlcmVkLlwiIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRoZSB1c2VybmFtZSBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nVXNlckJ5VXNlcm5hbWUgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZSB9KTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyQnlVc2VybmFtZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogXCJVc2VybmFtZSBhbHJlYWR5IHRha2VuLlwiIH0pO1xuICAgIH1cblxuICAgIC8vIEhhc2ggdGhlIHBhc3N3b3JkIHVzaW5nIEFyZ29uMlxuICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgYXJnb24yLmhhc2gocGFzc3dvcmQpO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyB0aGUgZmlyc3QgdXNlciBhbmQgbWFrZSB0aGVtIGFkbWluXG4gICAgY29uc3QgaXNGaXJzdFVzZXIgPSAoYXdhaXQgVXNlci5jb3VudERvY3VtZW50cygpKSA9PT0gMDtcblxuICAgIC8vIENyZWF0ZSB0aGUgdXNlclxuICAgIGNvbnN0IG5ld1VzZXIgPSBuZXcgVXNlcih7XG4gICAgICBlbWFpbCxcbiAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgIHVzZXJuYW1lLFxuICAgICAgaXNBZG1pbjogaXNGaXJzdFVzZXIsIC8vIEdyYW50IGFkbWluIGFjY2VzcyB0byB0aGUgZmlyc3QgdXNlclxuICAgIH0pO1xuXG4gICAgYXdhaXQgbmV3VXNlci5zYXZlKCk7XG5cbiAgICAvLyBTZW5kIHJlc3BvbnNlXG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24oe1xuICAgICAgbWVzc2FnZTogXCJVc2VyIHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5LlwiLFxuICAgICAgaXNBZG1pbjogbmV3VXNlci5pc0FkbWluLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJTZXJ2ZXIgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIgfSk7XG4gIH1cbn0pO1xuXG4vLyBQT1NUOiAvYXBpL2F1dGgvc2lnbmluXG5yb3V0ZXIucG9zdChcIi9zaWduaW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcblxuICB0cnkge1xuICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IGVtYWlsIH0pO1xuICAgIGlmICghdXNlcikge1xuICAgICAgY29uc29sZS5sb2coXCJVc2VyIG5vdCBmb3VuZCB3aXRoIGVtYWlsOlwiLCBlbWFpbCk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQuXCIgfSk7XG4gICAgfVxuXG4gICAgLy8gTG9nIHRoZSBmb3VuZCB1c2VyICh0byBkZWJ1ZyB0aGUgaXNzdWUpXG4gICAgY29uc29sZS5sb2coXCJVc2VyIGZvdW5kOlwiLCB1c2VyKTtcblxuICAgIC8vIFZlcmlmeSBwYXNzd29yZCB1c2luZyBBcmdvbjJcbiAgICBjb25zdCBpc01hdGNoID0gYXdhaXQgYXJnb24yLnZlcmlmeSh1c2VyLnBhc3N3b3JkLCBwYXNzd29yZCk7XG4gICAgaWYgKCFpc01hdGNoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlBhc3N3b3JkIG1pc21hdGNoIGZvciB1c2VyOlwiLCB1c2VyLnVzZXJuYW1lKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZC5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSB0b2tlblxuICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oeyBpZDogdXNlci5faWQsIGlzQWRtaW46IHVzZXIuaXNBZG1pbiB9LCBTRUNSRVRfS0VZLCB7XG4gICAgICBleHBpcmVzSW46IFwiMWhcIixcbiAgICB9KTtcblxuICAgIC8vIFNlbmQgdG9rZW4gYXMgYSBjb29raWVcbiAgICByZXMuY29va2llKFwidG9rZW5cIiwgdG9rZW4sIHtcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsIC8vIFNlY3VyZSBjb29raWVzIGluIHByb2R1Y3Rpb25cbiAgICB9KTtcblxuICAgIC8vIFJlc3BvbmQgd2l0aCB1c2VyIHJvbGVcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQWRtaW46IHVzZXIuaXNBZG1pbiB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiU2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiIH0pO1xuICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxhQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBNEIsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFIRTtBQUNROztBQUl0Q0csZUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQztBQUVmLE1BQU1DLE1BQU0sR0FBR0MsZ0JBQU8sQ0FBQ0MsTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsVUFBVSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsVUFBVTs7QUFFekM7QUFDQUgsTUFBTSxDQUFDTSxJQUFJLENBQUMsU0FBUyxFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ3pDLE1BQU07SUFBRUMsS0FBSztJQUFFQyxRQUFRO0lBQUVDO0VB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","map":{"version":3,"names":["_express","_interopRequireDefault","require","_argon","_User","_jsonwebtoken","_dotenv","e","__esModule","default","dotenv","config","router","express","Router","SECRET_KEY","process","env","post","req","res","email","password","username","body","status","json","message","existingUserByEmail","User","findOne","existingUserByUsername","hashedPassword","argon2","hash","isFirstUser","countDocuments","newUser","isAdmin","save","error","console","user","log","isMatch","verify","token","jwt","sign","id","_id","expiresIn","cookie","httpOnly","secure","NODE_ENV","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/","sources":["auth.js"],"sourcesContent":["import express from \"express\";\nimport argon2 from \"argon2\";  // Replacing bcryptjs with argon2\nimport User from \"../models/User.js\"; // Adjust the path based on your project structure\nimport jwt from \"jsonwebtoken\";\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\nconst router = express.Router();\nconst SECRET_KEY = process.env.SECRET_KEY;\n\n// Signup route\nrouter.post(\"/signup\", async (req, res) => {\n  const { email, password, username } = req.body;\n\n  try {\n    // Validate input\n    if (!email || !password || !username) {\n      return res.status(400).json({ message: \"All fields are required.\" });\n    }\n\n    // Check if the email already exists\n    const existingUserByEmail = await User.findOne({ email });\n    if (existingUserByEmail) {\n      return res.status(400).json({ message: \"Email already registered.\" });\n    }\n\n    // Check if the username already exists\n    const existingUserByUsername = await User.findOne({ username });\n    if (existingUserByUsername) {\n      return res.status(400).json({ message: \"Username already taken.\" });\n    }\n\n    // Hash the password using Argon2\n    const hashedPassword = await argon2.hash(password);\n\n    // Check if this is the first user and make them admin\n    const isFirstUser = (await User.countDocuments()) === 0;\n\n    // Create the user\n    const newUser = new User({\n      email,\n      password: hashedPassword,\n      username,\n      isAdmin: isFirstUser, // Grant admin access to the first user\n    });\n\n    await newUser.save();\n\n    // Send response\n    res.status(201).json({\n      message: \"User registered successfully.\",\n      isAdmin: newUser.isAdmin,\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({ message: \"Server error. Please try again later.\" });\n  }\n});\n\n// POST: /api/auth/signin\nrouter.post(\"/signin\", async (req, res) => {\n  const { email, password } = req.body;\n\n  try {\n    // Check if user exists\n    const user = await User.findOne({ email });\n    if (!user) {\n      console.log(\"User not found with email:\", email);\n      return res.status(400).json({ message: \"Invalid email or password.\" });\n    }\n\n    // Log the found user (to debug the issue)\n    console.log(\"User found:\", user);\n\n    // Verify password using Argon2\n    const isMatch = await argon2.verify(user.password, password);\n    if (!isMatch) {\n      console.log(\"Password mismatch for user:\", user.username);\n      return res.status(400).json({ message: \"Invalid email or password.\" });\n    }\n\n    // Generate token\n    const token = jwt.sign({ id: user._id, isAdmin: user.isAdmin }, SECRET_KEY, {\n      expiresIn: \"1h\",\n    });\n\n    // Send token as a cookie\n    res.cookie(\"token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\", // Secure cookies in production\n    });\n\n    // Respond with user role\n    res.status(200).json({ isAdmin: user.isAdmin });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({ message: \"Server error. Please try again later.\" });\n  }\n});\n\nexport default router;\n"],"mappings":"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","ignoreList":[]}},"mtime":1737828546555},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _argon = _interopRequireDefault(require(\"argon2\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Import argon2 instead of bcryptjs\n\nconst UserSchema = new _mongoose.default.Schema({\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  username: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  isAdmin: {\n    type: Boolean,\n    default: false\n  }\n});\n\n// Pre-save hook to hash password before saving it to the database\nUserSchema.pre(\"save\", async function (next) {\n  if (!this.isModified(\"password\")) return next(); // Only hash password if it's modified\n\n  try {\n    // Hash the password using Argon2\n    this.password = await _argon.default.hash(this.password, {\n      type: _argon.default.argon2id,\n      // Use the argon2id variant\n      memoryCost: 65536,\n      // 64MB of memory\n      timeCost: 3,\n      // 3 iterations\n      parallelism: 4 // 4 parallel threads\n    });\n    next();\n  } catch (error) {\n    next(error);\n  }\n});\nvar _default = exports.default = _mongoose.default.model(\"User\", UserSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hcmdvbiIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlVzZXJTY2hlbWEiLCJtb25nb29zZSIsIlNjaGVtYSIsImVtYWlsIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidW5pcXVlIiwicGFzc3dvcmQiLCJ1c2VybmFtZSIsImlzQWRtaW4iLCJCb29sZWFuIiwicHJlIiwibmV4dCIsImlzTW9kaWZpZWQiLCJhcmdvbjIiLCJoYXNoIiwiYXJnb24yaWQiLCJtZW1vcnlDb3N0IiwidGltZUNvc3QiLCJwYXJhbGxlbGlzbSIsImVycm9yIiwiX2RlZmF1bHQiLCJleHBvcnRzIiwibW9kZWwiXSwic291cmNlUm9vdCI6Ii9ob21lL3B1cnBsZV9xdWFzYXIvQUxYX1NFL2FseC13ZWJzdGFjay1wb3J0Zm9saW8tcHJvamVjdC9hbmNob3ItZS1jb21tZXJjZS1zaXRlL2JhY2tlbmQvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGFyZ29uMiBmcm9tIFwiYXJnb24yXCI7IC8vIEltcG9ydCBhcmdvbjIgaW5zdGVhZCBvZiBiY3J5cHRqc1xuXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICBwYXNzd29yZDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIHVzZXJuYW1lOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICBpc0FkbWluOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sXG59KTtcblxuLy8gUHJlLXNhdmUgaG9vayB0byBoYXNoIHBhc3N3b3JkIGJlZm9yZSBzYXZpbmcgaXQgdG8gdGhlIGRhdGFiYXNlXG5Vc2VyU2NoZW1hLnByZShcInNhdmVcIiwgYXN5bmMgZnVuY3Rpb24gKG5leHQpIHtcbiAgaWYgKCF0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkgcmV0dXJuIG5leHQoKTsgLy8gT25seSBoYXNoIHBhc3N3b3JkIGlmIGl0J3MgbW9kaWZpZWRcblxuICB0cnkge1xuICAgIC8vIEhhc2ggdGhlIHBhc3N3b3JkIHVzaW5nIEFyZ29uMlxuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBhcmdvbjIuaGFzaCh0aGlzLnBhc3N3b3JkLCB7XG4gICAgICB0eXBlOiBhcmdvbjIuYXJnb24yaWQsICAvLyBVc2UgdGhlIGFyZ29uMmlkIHZhcmlhbnRcbiAgICAgIG1lbW9yeUNvc3Q6IDY1NTM2LCAgICAgICAvLyA2NE1CIG9mIG1lbW9yeVxuICAgICAgdGltZUNvc3Q6IDMsICAgICAgICAgICAgIC8vIDMgaXRlcmF0aW9uc1xuICAgICAgcGFyYWxsZWxpc206IDQgICAgICAgICAgIC8vIDQgcGFyYWxsZWwgdGhyZWFkc1xuICAgIH0pO1xuICAgIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IG1vbmdvb3NlLm1vZGVsKFwiVXNlclwiLCBVc2VyU2NoZW1hKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsTUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQTRCLFNBQUFELHVCQUFBRyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUM7O0FBRTdCLE1BQU1HLFVBQVUsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDckNDLEtBQUssRUFBRTtJQUFFQyxJQUFJLEVBQUVDLE1BQU07SUFBRUMsUUFBUSxFQUFFLElBQUk7SUFBRUMsTUFBTSxFQUFFO0VBQUssQ0FBQztFQUNyREMsUUFBUSxFQUFFO0lBQUVKLElBQUksRUFBRUMsTUFBTTtJQUFFQyxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQzFDRyxRQUFRLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFNO0lBQUVDLFFBQVEsRUFBRSxJQUFJO0lBQUVDLE1BQU0sRUFBRTtFQUFLLENBQUM7RUFDeERHLE9BQU8sRUFBRTtJQUFFTixJQUFJLEVBQUVPLE9BQU87SUFBRVosT0FBTyxFQUFFO0VBQU07QUFDM0MsQ0FBQyxDQUFDOztBQUVGO0FBQ0FDLFVBQVUsQ0FBQ1ksR0FBRyxDQUFDLE1BQU0sRUFBRSxnQkFBZ0JDLElBQUksRUFBRTtFQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsT0FBT0QsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDOztFQUVqRCxJQUFJO0lBQ0Y7SUFDQSxJQUFJLENBQUNMLFFBQVEsR0FBRyxNQUFNTyxjQUFNLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUNSLFFBQVEsRUFBRTtNQUMvQ0osSUFBSSxFQUFFVyxjQUFNLENBQUNFLFFBQVE7TUFBRztNQUN4QkMsVUFBVSxFQUFFLEtBQUs7TUFBUTtNQUN6QkMsUUFBUSxFQUFFLENBQUM7TUFBYztNQUN6QkMsV0FBVyxFQUFFLENBQUMsQ0FBVztJQUMzQixDQUFDLENBQUM7SUFDRlAsSUFBSSxDQUFDLENBQUM7RUFDUixDQUFDLENBQUMsT0FBT1EsS0FBSyxFQUFFO0lBQ2RSLElBQUksQ0FBQ1EsS0FBSyxDQUFDO0VBQ2I7QUFDRixDQUFDLENBQUM7QUFBQyxJQUFBQyxRQUFBLEdBQUFDLE9BQUEsQ0FBQXhCLE9BQUEsR0FFWUUsaUJBQVEsQ0FBQ3VCLEtBQUssQ0FBQyxNQUFNLEVBQUV4QixVQUFVLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_argon","e","__esModule","default","UserSchema","mongoose","Schema","email","type","String","required","unique","password","username","isAdmin","Boolean","pre","next","isModified","argon2","hash","argon2id","memoryCost","timeCost","parallelism","error","_default","exports","model"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/","sources":["User.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport argon2 from \"argon2\"; // Import argon2 instead of bcryptjs\n\nconst UserSchema = new mongoose.Schema({\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n  username: { type: String, required: true, unique: true },\n  isAdmin: { type: Boolean, default: false },\n});\n\n// Pre-save hook to hash password before saving it to the database\nUserSchema.pre(\"save\", async function (next) {\n  if (!this.isModified(\"password\")) return next(); // Only hash password if it's modified\n\n  try {\n    // Hash the password using Argon2\n    this.password = await argon2.hash(this.password, {\n      type: argon2.argon2id,  // Use the argon2id variant\n      memoryCost: 65536,       // 64MB of memory\n      timeCost: 3,             // 3 iterations\n      parallelism: 4           // 4 parallel threads\n    });\n    next();\n  } catch (error) {\n    next(error);\n  }\n});\n\nexport default mongoose.model(\"User\", UserSchema);\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,MAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAC;;AAE7B,MAAMG,UAAU,GAAG,IAAIC,iBAAQ,CAACC,MAAM,CAAC;EACrCC,KAAK,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC;EACrDC,QAAQ,EAAE;IAAEJ,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAK,CAAC;EAC1CG,QAAQ,EAAE;IAAEL,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC;EACxDG,OAAO,EAAE;IAAEN,IAAI,EAAEO,OAAO;IAAEZ,OAAO,EAAE;EAAM;AAC3C,CAAC,CAAC;;AAEF;AACAC,UAAU,CAACY,GAAG,CAAC,MAAM,EAAE,gBAAgBC,IAAI,EAAE;EAC3C,IAAI,CAAC,IAAI,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE,OAAOD,IAAI,CAAC,CAAC,CAAC,CAAC;;EAEjD,IAAI;IACF;IACA,IAAI,CAACL,QAAQ,GAAG,MAAMO,cAAM,CAACC,IAAI,CAAC,IAAI,CAACR,QAAQ,EAAE;MAC/CJ,IAAI,EAAEW,cAAM,CAACE,QAAQ;MAAG;MACxBC,UAAU,EAAE,KAAK;MAAQ;MACzBC,QAAQ,EAAE,CAAC;MAAc;MACzBC,WAAW,EAAE,CAAC,CAAW;IAC3B,CAAC,CAAC;IACFP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOQ,KAAK,EAAE;IACdR,IAAI,CAACQ,KAAK,CAAC;EACb;AACF,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAxB,OAAA,GAEYE,iBAAQ,CAACuB,KAAK,CAAC,MAAM,EAAExB,UAAU,CAAC","ignoreList":[]}},"mtime":1737829755160},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _argon = _interopRequireDefault(require(\"argon2\"));\nvar _User = _interopRequireDefault(require(\"../models/User.js\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Replacing bcryptjs with argon2\n// Adjust the path based on your project structure\n\n_dotenv.default.config();\nconst router = _express.default.Router();\nconst SECRET_KEY = process.env.SECRET_KEY;\n\n// Signup route\nrouter.post(\"/signup\", async (req, res) => {\n  const {\n    email,\n    password,\n    username\n  } = req.body;\n  try {\n    // Validate input\n    if (!email || !password || !username) {\n      return res.status(400).json({\n        message: \"All fields are required.\"\n      });\n    }\n\n    // Check if the email already exists\n    const existingUserByEmail = await _User.default.findOne({\n      email\n    });\n    if (existingUserByEmail) {\n      return res.status(400).json({\n        message: \"Email already registered.\"\n      });\n    }\n\n    // Check if the username already exists\n    const existingUserByUsername = await _User.default.findOne({\n      username\n    });\n    if (existingUserByUsername) {\n      return res.status(400).json({\n        message: \"Username already taken.\"\n      });\n    }\n\n    // Create the user without manually hashing the password\n    const isFirstUser = (await _User.default.countDocuments()) === 0;\n    const newUser = new _User.default({\n      email,\n      password,\n      // Don't hash the password here, as the pre-save hook will do it\n      username,\n      isAdmin: isFirstUser // Grant admin access to the first user\n    });\n    await newUser.save();\n\n    // Send response\n    res.status(201).json({\n      message: \"User registered successfully.\",\n      isAdmin: newUser.isAdmin\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      message: \"Server error. Please try again later.\"\n    });\n  }\n});\n\n// POST: /api/auth/signin\nrouter.post(\"/signin\", async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n  try {\n    // Check if user exists\n    const user = await _User.default.findOne({\n      email\n    });\n    if (!user) {\n      console.log(\"User not found with email:\", email);\n      return res.status(400).json({\n        message: \"Invalid email or password.\"\n      });\n    }\n\n    // Log the found user (to debug the issue)\n    console.log(\"User found:\", user);\n\n    // Verify password using Argon2\n    const isMatch = await _argon.default.verify(user.password, password);\n    if (!isMatch) {\n      return res.status(400).json({\n        message: \"Invalid email or password.\"\n      });\n    }\n\n    // Generate token\n    const token = _jsonwebtoken.default.sign({\n      id: user._id,\n      isAdmin: user.isAdmin\n    }, SECRET_KEY, {\n      expiresIn: \"1h\"\n    });\n\n    // Send token as a cookie\n    res.cookie(\"token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\" // Secure cookies in production\n    });\n\n    // Determine redirect URL based on role\n    const redirectUrl = user.isAdmin ? \"/admin-dashboard\" : \"/user-dashboard\";\n\n    // Respond with user role and redirect URL\n    res.status(200).json({\n      message: \"Login successful.\",\n      isAdmin: user.isAdmin,\n      redirectUrl\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      message: \"Server error. Please try again later.\"\n    });\n  }\n});\nvar _default = exports.default = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2FyZ29uIiwiX1VzZXIiLCJfanNvbndlYnRva2VuIiwiX2RvdGVudiIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImRvdGVudiIsImNvbmZpZyIsInJvdXRlciIsImV4cHJlc3MiLCJSb3V0ZXIiLCJTRUNSRVRfS0VZIiwicHJvY2VzcyIsImVudiIsInBvc3QiLCJyZXEiLCJyZXMiLCJlbWFpbCIsInBhc3N3b3JkIiwidXNlcm5hbWUiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJleGlzdGluZ1VzZXJCeUVtYWlsIiwiVXNlciIsImZpbmRPbmUiLCJleGlzdGluZ1VzZXJCeVVzZXJuYW1lIiwiaXNGaXJzdFVzZXIiLCJjb3VudERvY3VtZW50cyIsIm5ld1VzZXIiLCJpc0FkbWluIiwic2F2ZSIsImVycm9yIiwiY29uc29sZSIsInVzZXIiLCJsb2ciLCJpc01hdGNoIiwiYXJnb24yIiwidmVyaWZ5IiwidG9rZW4iLCJqd3QiLCJzaWduIiwiaWQiLCJfaWQiLCJleHBpcmVzSW4iLCJjb29raWUiLCJodHRwT25seSIsInNlY3VyZSIsIk5PREVfRU5WIiwicmVkaXJlY3RVcmwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL3B1cnBsZV9xdWFzYXIvQUxYX1NFL2FseC13ZWJzdGFjay1wb3J0Zm9saW8tcHJvamVjdC9hbmNob3ItZS1jb21tZXJjZS1zaXRlL2JhY2tlbmQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImF1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCBhcmdvbjIgZnJvbSBcImFyZ29uMlwiOyAgLy8gUmVwbGFjaW5nIGJjcnlwdGpzIHdpdGggYXJnb24yXG5pbXBvcnQgVXNlciBmcm9tIFwiLi4vbW9kZWxzL1VzZXIuanNcIjsgLy8gQWRqdXN0IHRoZSBwYXRoIGJhc2VkIG9uIHlvdXIgcHJvamVjdCBzdHJ1Y3R1cmVcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XG5cbmRvdGVudi5jb25maWcoKTtcblxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbmNvbnN0IFNFQ1JFVF9LRVkgPSBwcm9jZXNzLmVudi5TRUNSRVRfS0VZO1xuXG4vLyBTaWdudXAgcm91dGVcbnJvdXRlci5wb3N0KFwiL3NpZ251cFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQsIHVzZXJuYW1lIH0gPSByZXEuYm9keTtcblxuICB0cnkge1xuICAgIC8vIFZhbGlkYXRlIGlucHV0XG4gICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQgfHwgIXVzZXJuYW1lKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIkFsbCBmaWVsZHMgYXJlIHJlcXVpcmVkLlwiIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRoZSBlbWFpbCBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nVXNlckJ5RW1haWwgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbCB9KTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyQnlFbWFpbCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogXCJFbWFpbCBhbHJlYWR5IHJlZ2lzdGVyZWQuXCIgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHVzZXJuYW1lIGFscmVhZHkgZXhpc3RzXG4gICAgY29uc3QgZXhpc3RpbmdVc2VyQnlVc2VybmFtZSA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lIH0pO1xuICAgIGlmIChleGlzdGluZ1VzZXJCeVVzZXJuYW1lKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIlVzZXJuYW1lIGFscmVhZHkgdGFrZW4uXCIgfSk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRoZSB1c2VyIHdpdGhvdXQgbWFudWFsbHkgaGFzaGluZyB0aGUgcGFzc3dvcmRcbiAgICBjb25zdCBpc0ZpcnN0VXNlciA9IChhd2FpdCBVc2VyLmNvdW50RG9jdW1lbnRzKCkpID09PSAwO1xuICAgIGNvbnN0IG5ld1VzZXIgPSBuZXcgVXNlcih7XG4gICAgICBlbWFpbCxcbiAgICAgIHBhc3N3b3JkLCAgLy8gRG9uJ3QgaGFzaCB0aGUgcGFzc3dvcmQgaGVyZSwgYXMgdGhlIHByZS1zYXZlIGhvb2sgd2lsbCBkbyBpdFxuICAgICAgdXNlcm5hbWUsXG4gICAgICBpc0FkbWluOiBpc0ZpcnN0VXNlciwgLy8gR3JhbnQgYWRtaW4gYWNjZXNzIHRvIHRoZSBmaXJzdCB1c2VyXG4gICAgfSk7XG5cbiAgICBhd2FpdCBuZXdVc2VyLnNhdmUoKTtcblxuICAgIC8vIFNlbmQgcmVzcG9uc2VcbiAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7XG4gICAgICBtZXNzYWdlOiBcIlVzZXIgcmVnaXN0ZXJlZCBzdWNjZXNzZnVsbHkuXCIsXG4gICAgICBpc0FkbWluOiBuZXdVc2VyLmlzQWRtaW4sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIlNlcnZlciBlcnJvci4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiB9KTtcbiAgfVxufSk7XG5cbi8vIFBPU1Q6IC9hcGkvYXV0aC9zaWduaW5cbnJvdXRlci5wb3N0KFwiL3NpZ25pblwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHNcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlVzZXIgbm90IGZvdW5kIHdpdGggZW1haWw6XCIsIGVtYWlsKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZC5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBMb2cgdGhlIGZvdW5kIHVzZXIgKHRvIGRlYnVnIHRoZSBpc3N1ZSlcbiAgICBjb25zb2xlLmxvZyhcIlVzZXIgZm91bmQ6XCIsIHVzZXIpO1xuXG4gICAgLy8gVmVyaWZ5IHBhc3N3b3JkIHVzaW5nIEFyZ29uMlxuICAgIGNvbnN0IGlzTWF0Y2ggPSBhd2FpdCBhcmdvbjIudmVyaWZ5KHVzZXIucGFzc3dvcmQsIHBhc3N3b3JkKTtcbiAgICBpZiAoIWlzTWF0Y2gpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZC5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSB0b2tlblxuICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oeyBpZDogdXNlci5faWQsIGlzQWRtaW46IHVzZXIuaXNBZG1pbiB9LCBTRUNSRVRfS0VZLCB7XG4gICAgICBleHBpcmVzSW46IFwiMWhcIixcbiAgICB9KTtcblxuICAgIC8vIFNlbmQgdG9rZW4gYXMgYSBjb29raWVcbiAgICByZXMuY29va2llKFwidG9rZW5cIiwgdG9rZW4sIHtcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsIC8vIFNlY3VyZSBjb29raWVzIGluIHByb2R1Y3Rpb25cbiAgICB9KTtcblxuICAgIC8vIERldGVybWluZSByZWRpcmVjdCBVUkwgYmFzZWQgb24gcm9sZVxuICAgIGNvbnN0IHJlZGlyZWN0VXJsID0gdXNlci5pc0FkbWluID8gXCIvYWRtaW4tZGFzaGJvYXJkXCIgOiBcIi91c2VyLWRhc2hib2FyZFwiO1xuXG4gICAgLy8gUmVzcG9uZCB3aXRoIHVzZXIgcm9sZSBhbmQgcmVkaXJlY3QgVVJMXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgbWVzc2FnZTogXCJMb2dpbiBzdWNjZXNzZnVsLlwiLFxuICAgICAgaXNBZG1pbjogdXNlci5pc0FkbWluLFxuICAgICAgcmVkaXJlY3RVcmwsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIlNlcnZlciBlcnJvci4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiB9KTtcbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcblxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxhQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBNEIsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFIRTtBQUNROztBQUl0Q0csZUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQztBQUVmLE1BQU1DLE1BQU0sR0FBR0MsZ0JBQU8sQ0FBQ0MsTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsVUFBVSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsVUFBVTs7QUFFekM7QUFDQUgsTUFBTSxDQUFDTSxJQUFJLENBQUMsU0FBUyxF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","map":{"version":3,"names":["_express","_interopRequireDefault","require","_argon","_User","_jsonwebtoken","_dotenv","e","__esModule","default","dotenv","config","router","express","Router","SECRET_KEY","process","env","post","req","res","email","password","username","body","status","json","message","existingUserByEmail","User","findOne","existingUserByUsername","isFirstUser","countDocuments","newUser","isAdmin","save","error","console","user","log","isMatch","argon2","verify","token","jwt","sign","id","_id","expiresIn","cookie","httpOnly","secure","NODE_ENV","redirectUrl","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/","sources":["auth.js"],"sourcesContent":["import express from \"express\";\nimport argon2 from \"argon2\";  // Replacing bcryptjs with argon2\nimport User from \"../models/User.js\"; // Adjust the path based on your project structure\nimport jwt from \"jsonwebtoken\";\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\nconst router = express.Router();\nconst SECRET_KEY = process.env.SECRET_KEY;\n\n// Signup route\nrouter.post(\"/signup\", async (req, res) => {\n  const { email, password, username } = req.body;\n\n  try {\n    // Validate input\n    if (!email || !password || !username) {\n      return res.status(400).json({ message: \"All fields are required.\" });\n    }\n\n    // Check if the email already exists\n    const existingUserByEmail = await User.findOne({ email });\n    if (existingUserByEmail) {\n      return res.status(400).json({ message: \"Email already registered.\" });\n    }\n\n    // Check if the username already exists\n    const existingUserByUsername = await User.findOne({ username });\n    if (existingUserByUsername) {\n      return res.status(400).json({ message: \"Username already taken.\" });\n    }\n\n    // Create the user without manually hashing the password\n    const isFirstUser = (await User.countDocuments()) === 0;\n    const newUser = new User({\n      email,\n      password,  // Don't hash the password here, as the pre-save hook will do it\n      username,\n      isAdmin: isFirstUser, // Grant admin access to the first user\n    });\n\n    await newUser.save();\n\n    // Send response\n    res.status(201).json({\n      message: \"User registered successfully.\",\n      isAdmin: newUser.isAdmin,\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({ message: \"Server error. Please try again later.\" });\n  }\n});\n\n// POST: /api/auth/signin\nrouter.post(\"/signin\", async (req, res) => {\n  const { email, password } = req.body;\n\n  try {\n    // Check if user exists\n    const user = await User.findOne({ email });\n    if (!user) {\n      console.log(\"User not found with email:\", email);\n      return res.status(400).json({ message: \"Invalid email or password.\" });\n    }\n\n    // Log the found user (to debug the issue)\n    console.log(\"User found:\", user);\n\n    // Verify password using Argon2\n    const isMatch = await argon2.verify(user.password, password);\n    if (!isMatch) {\n      return res.status(400).json({ message: \"Invalid email or password.\" });\n    }\n\n    // Generate token\n    const token = jwt.sign({ id: user._id, isAdmin: user.isAdmin }, SECRET_KEY, {\n      expiresIn: \"1h\",\n    });\n\n    // Send token as a cookie\n    res.cookie(\"token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\", // Secure cookies in production\n    });\n\n    // Determine redirect URL based on role\n    const redirectUrl = user.isAdmin ? \"/admin-dashboard\" : \"/user-dashboard\";\n\n    // Respond with user role and redirect URL\n    res.status(200).json({\n      message: \"Login successful.\",\n      isAdmin: user.isAdmin,\n      redirectUrl,\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({ message: \"Server error. Please try again later.\" });\n  }\n});\n\nexport default router;\n\n"],"mappings":"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","ignoreList":[]}},"mtime":1737835306572},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _Product = _interopRequireDefault(require(\"../models/Product.js\"));\nvar _verifyAdmin = _interopRequireDefault(require(\"../middlewares/verifyAdmin.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst router = _express.default.Router();\nrouter.post(\"/admin/product\", _verifyAdmin.default, async (req, res) => {\n  const {\n    name,\n    description,\n    price,\n    category\n  } = req.body;\n  try {\n    const newProduct = new _Product.default({\n      name,\n      description,\n      price,\n      category\n    });\n    await newProduct.save();\n    res.status(201).json({\n      message: \"Product added successfully\"\n    });\n  } catch (error) {\n    res.status(500).json({\n      message: \"Server error\"\n    });\n  }\n});\nvar _default = exports.default = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX1Byb2R1Y3QiLCJfdmVyaWZ5QWRtaW4iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJyb3V0ZXIiLCJleHByZXNzIiwiUm91dGVyIiwicG9zdCIsInZlcmlmeUFkbWluIiwicmVxIiwicmVzIiwibmFtZSIsImRlc2NyaXB0aW9uIiwicHJpY2UiLCJjYXRlZ29yeSIsImJvZHkiLCJuZXdQcm9kdWN0IiwiUHJvZHVjdCIsInNhdmUiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVycm9yIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJwcm9kdWN0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IFByb2R1Y3QgZnJvbSBcIi4uL21vZGVscy9Qcm9kdWN0LmpzXCI7XG5pbXBvcnQgdmVyaWZ5QWRtaW4gZnJvbSBcIi4uL21pZGRsZXdhcmVzL3ZlcmlmeUFkbWluLmpzXCI7XG5cbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbnJvdXRlci5wb3N0KFwiL2FkbWluL3Byb2R1Y3RcIiwgdmVyaWZ5QWRtaW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBjYXRlZ29yeSB9ID0gcmVxLmJvZHk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBuZXdQcm9kdWN0ID0gbmV3IFByb2R1Y3QoeyBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGNhdGVnb3J5IH0pO1xuICAgICAgICBhd2FpdCBuZXdQcm9kdWN0LnNhdmUoKTtcbiAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBtZXNzYWdlOiBcIlByb2R1Y3QgYWRkZWQgc3VjY2Vzc2Z1bGx5XCIgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIlNlcnZlciBlcnJvclwiIH0pO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFlBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3RCxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUV4RCxNQUFNRyxNQUFNLEdBQUdDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBRS9CRixNQUFNLENBQUNHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRUMsb0JBQVcsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMzRCxNQUFNO0lBQUVDLElBQUk7SUFBRUMsV0FBVztJQUFFQyxLQUFLO0lBQUVDO0VBQVMsQ0FBQyxHQUFHTCxHQUFHLENBQUNNLElBQUk7RUFFdkQsSUFBSTtJQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJQyxnQkFBTyxDQUFDO01BQUVOLElBQUk7TUFBRUMsV0FBVztNQUFFQyxLQUFLO01BQUVDO0lBQVMsQ0FBQyxDQUFDO0lBQ3RFLE1BQU1FLFVBQVUsQ0FBQ0UsSUFBSSxDQUFDLENBQUM7SUFDdkJSLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQTZCLENBQUMsQ0FBQztFQUNuRSxDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO0lBQ1paLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQWUsQ0FBQyxDQUFDO0VBQ3JEO0FBQ0osQ0FBQyxDQUFDO0FBQUMsSUFBQUUsUUFBQSxHQUFBQyxPQUFBLENBQUFyQixPQUFBLEdBRVlDLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_express","_interopRequireDefault","require","_Product","_verifyAdmin","e","__esModule","default","router","express","Router","post","verifyAdmin","req","res","name","description","price","category","body","newProduct","Product","save","status","json","message","error","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/","sources":["products.js"],"sourcesContent":["import express from \"express\";\nimport Product from \"../models/Product.js\";\nimport verifyAdmin from \"../middlewares/verifyAdmin.js\";\n\nconst router = express.Router();\n\nrouter.post(\"/admin/product\", verifyAdmin, async (req, res) => {\n    const { name, description, price, category } = req.body;\n\n    try {\n        const newProduct = new Product({ name, description, price, category });\n        await newProduct.save();\n        res.status(201).json({ message: \"Product added successfully\" });\n    } catch (error) {\n        res.status(500).json({ message: \"Server error\" });\n    }\n});\n\nexport default router;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,YAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAwD,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAExD,MAAMG,MAAM,GAAGC,gBAAO,CAACC,MAAM,CAAC,CAAC;AAE/BF,MAAM,CAACG,IAAI,CAAC,gBAAgB,EAAEC,oBAAW,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC3D,MAAM;IAAEC,IAAI;IAAEC,WAAW;IAAEC,KAAK;IAAEC;EAAS,CAAC,GAAGL,GAAG,CAACM,IAAI;EAEvD,IAAI;IACA,MAAMC,UAAU,GAAG,IAAIC,gBAAO,CAAC;MAAEN,IAAI;MAAEC,WAAW;MAAEC,KAAK;MAAEC;IAAS,CAAC,CAAC;IACtE,MAAME,UAAU,CAACE,IAAI,CAAC,CAAC;IACvBR,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA6B,CAAC,CAAC;EACnE,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZZ,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAe,CAAC,CAAC;EACrD;AACJ,CAAC,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAArB,OAAA,GAEYC,MAAM","ignoreList":[]}},"mtime":1737804265184},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/Product.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _shortUuid = _interopRequireDefault(require(\"short-uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst productSchema = new _mongoose.default.Schema({\n  id: {\n    type: String,\n    default: () => new Date().toISOString(),\n    // This will create a timestamp in ISO format\n    unique: true\n  },\n  createdBy: {\n    type: String,\n    default: 'shiftyshadows' // Current user's login\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  description: {\n    type: String\n  },\n  featured: {\n    type: Boolean,\n    default: false\n  },\n  image: {\n    type: String,\n    required: true\n  },\n  stock: {\n    type: Number,\n    required: true,\n    min: 0\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n    get: function (date) {\n      return date.toISOString().slice(0, 19).replace('T', ' '); // Formats to YYYY-MM-DD HH:MM:SS\n    }\n  }\n}, {\n  timestamps: true,\n  // This will add createdAt and updatedAt fields automatically\n  toJSON: {\n    getters: true\n  } // This ensures the getter for createdAt is used when converting to JSON\n});\n\n// Add a virtual to store numeric price without currency\nproductSchema.virtual('numericPrice').get(function () {\n  const numericValue = this.price.replace(/[^0-9.]/g, ''); // Extract numeric value\n  return parseFloat(numericValue) || 0;\n});\n\n// Create and export the Product model\nconst Product = _mongoose.default.model('Product', productSchema);\nvar _default = exports.default = Product;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9zaG9ydFV1aWQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJwcm9kdWN0U2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJpZCIsInR5cGUiLCJTdHJpbmciLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1bmlxdWUiLCJjcmVhdGVkQnkiLCJuYW1lIiwicmVxdWlyZWQiLCJwcmljZSIsIk51bWJlciIsImRlc2NyaXB0aW9uIiwiZmVhdHVyZWQiLCJCb29sZWFuIiwiaW1hZ2UiLCJzdG9jayIsIm1pbiIsImNyZWF0ZWRBdCIsIm5vdyIsImdldCIsImRhdGUiLCJzbGljZSIsInJlcGxhY2UiLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwiZ2V0dGVycyIsInZpcnR1YWwiLCJudW1lcmljVmFsdWUiLCJwYXJzZUZsb2F0IiwiUHJvZHVjdCIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy9tb2RlbHMvIiwic291cmNlcyI6WyJQcm9kdWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgU2hvcnRVVUlEIGZyb20gJ3Nob3J0LXV1aWQnO1xuXG5jb25zdCBwcm9kdWN0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIGlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAoKSA9PiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIC8vIFRoaXMgd2lsbCBjcmVhdGUgYSB0aW1lc3RhbXAgaW4gSVNPIGZvcm1hdFxuICAgICAgdW5pcXVlOiB0cnVlXG4gIH0sXG4gIGNyZWF0ZWRCeToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogJ3NoaWZ0eXNoYWRvd3MnIC8vIEN1cnJlbnQgdXNlcidzIGxvZ2luXG4gIH0sXG4gIG5hbWU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICBwcmljZTogeyB0eXBlOiBOdW1iZXIsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIGRlc2NyaXB0aW9uOiB7IHR5cGU6IFN0cmluZyB9LFxuICBmZWF0dXJlZDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxuICBpbWFnZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIHN0b2NrOiB7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUsIG1pbjogMCB9LFxuICBjcmVhdGVkQXQ6IHtcbiAgICAgIHR5cGU6IERhdGUsXG4gICAgICBkZWZhdWx0OiBEYXRlLm5vdyxcbiAgICAgIGdldDogZnVuY3Rpb24oZGF0ZSkge1xuICAgICAgICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoJ1QnLCAnICcpOyAvLyBGb3JtYXRzIHRvIFlZWVktTU0tREQgSEg6TU06U1NcbiAgICAgIH1cbiAgfVxufSwge1xuICAgIHRpbWVzdGFtcHM6IHRydWUsIC8vIFRoaXMgd2lsbCBhZGQgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgZmllbGRzIGF1dG9tYXRpY2FsbHlcbiAgICB0b0pTT046IHsgZ2V0dGVyczogdHJ1ZSB9LCAvLyBUaGlzIGVuc3VyZXMgdGhlIGdldHRlciBmb3IgY3JlYXRlZEF0IGlzIHVzZWQgd2hlbiBjb252ZXJ0aW5nIHRvIEpTT05cbn0pO1xuXG4vLyBBZGQgYSB2aXJ0dWFsIHRvIHN0b3JlIG51bWVyaWMgcHJpY2Ugd2l0aG91dCBjdXJyZW5jeVxucHJvZHVjdFNjaGVtYS52aXJ0dWFsKCdudW1lcmljUHJpY2UnKS5nZXQoZnVuY3Rpb24gKCkge1xuICBjb25zdCBudW1lcmljVmFsdWUgPSB0aGlzLnByaWNlLnJlcGxhY2UoL1teMC05Ll0vZywgJycpOyAvLyBFeHRyYWN0IG51bWVyaWMgdmFsdWVcbiAgcmV0dXJuIHBhcnNlRmxvYXQobnVtZXJpY1ZhbHVlKSB8fCAwO1xufSk7XG5cbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSBQcm9kdWN0IG1vZGVsXG5jb25zdCBQcm9kdWN0ID0gbW9uZ29vc2UubW9kZWwoJ1Byb2R1Y3QnLCBwcm9kdWN0U2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgUHJvZHVjdDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQW1DLFNBQUFELHVCQUFBRyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRW5DLE1BQU1HLGFBQWEsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDeENDLEVBQUUsRUFBRTtJQUNBQyxJQUFJLEVBQUVDLE1BQU07SUFDWk4sT0FBTyxFQUFFQSxDQUFBLEtBQU0sSUFBSU8sSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7SUFBRTtJQUN6Q0MsTUFBTSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDUEwsSUFBSSxFQUFFQyxNQUFNO0lBQ1pOLE9BQU8sRUFBRSxlQUFlLENBQUM7RUFDN0IsQ0FBQztFQUNEVyxJQUFJLEVBQUU7SUFBRU4sSUFBSSxFQUFFQyxNQUFNO0lBQUVNLFFBQVEsRUFBRTtFQUFLLENBQUM7RUFDdENDLEtBQUssRUFBRTtJQUFFUixJQUFJLEVBQUVTLE1BQU07SUFBRUYsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUN2Q0csV0FBVyxFQUFFO0lBQUVWLElBQUksRUFBRUM7RUFBTyxDQUFDO0VBQzdCVSxRQUFRLEVBQUU7SUFBRVgsSUFBSSxFQUFFWSxPQUFPO0lBQUVqQixPQUFPLEVBQUU7RUFBTSxDQUFDO0VBQzNDa0IsS0FBSyxFQUFFO0lBQUViLElBQUksRUFBRUMsTUFBTTtJQUFFTSxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQ3ZDTyxLQUFLLEVBQUU7SUFBRWQsSUFBSSxFQUFFUyxNQUFNO0lBQUVGLFFBQVEsRUFBRSxJQUFJO0lBQUVRLEdBQUcsRUFBRTtFQUFFLENBQUM7RUFDL0NDLFNBQVMsRUFBRTtJQUNQaEIsSUFBSSxFQUFFRSxJQUFJO0lBQ1ZQLE9BQU8sRUFBRU8sSUFBSSxDQUFDZSxHQUFHO0lBQ2pCQyxHQUFHLEVBQUUsU0FBQUEsQ0FBU0MsSUFBSSxFQUFFO01BQ2hCLE9BQU9BLElBQUksQ0FBQ2hCLFdBQVcsQ0FBQyxDQUFDLENBQUNpQixLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDOUQ7RUFDSjtBQUNGLENBQUMsRUFBRTtFQUNDQyxVQUFVLEVBQUUsSUFBSTtFQUFFO0VBQ2xCQyxNQUFNLEVBQUU7SUFBRUMsT0FBTyxFQUFFO0VBQUssQ0FBQyxDQUFFO0FBQy9CLENBQUMsQ0FBQzs7QUFFRjtBQUNBNUIsYUFBYSxDQUFDNkIsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDUCxHQUFHLENBQUMsWUFBWTtFQUNwRCxNQUFNUSxZQUFZLEdBQUcsSUFBSSxDQUFDbEIsS0FBSyxDQUFDYSxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7RUFDekQsT0FBT00sVUFBVSxDQUFDRCxZQUFZLENBQUMsSUFBSSxDQUFDO0FBQ3RDLENBQUMsQ0FBQzs7QUFFRjtBQUNBLE1BQU1FLE9BQU8sR0FBRy9CLGlCQUFRLENBQUNnQyxLQUFLLENBQUMsU0FBUyxFQUFFakMsYUFBYSxDQUFDO0FBQUMsSUFBQWtDLFFBQUEsR0FBQUMsT0FBQSxDQUFBcEMsT0FBQSxHQUUxQ2lDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_shortUuid","e","__esModule","default","productSchema","mongoose","Schema","id","type","String","Date","toISOString","unique","createdBy","name","required","price","Number","description","featured","Boolean","image","stock","min","createdAt","now","get","date","slice","replace","timestamps","toJSON","getters","virtual","numericValue","parseFloat","Product","model","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/","sources":["Product.js"],"sourcesContent":["import mongoose from 'mongoose';\nimport ShortUUID from 'short-uuid';\n\nconst productSchema = new mongoose.Schema({\n  id: {\n      type: String,\n      default: () => new Date().toISOString(), // This will create a timestamp in ISO format\n      unique: true\n  },\n  createdBy: {\n      type: String,\n      default: 'shiftyshadows' // Current user's login\n  },\n  name: { type: String, required: true },\n  price: { type: Number, required: true },\n  description: { type: String },\n  featured: { type: Boolean, default: false },\n  image: { type: String, required: true },\n  stock: { type: Number, required: true, min: 0 },\n  createdAt: {\n      type: Date,\n      default: Date.now,\n      get: function(date) {\n          return date.toISOString().slice(0, 19).replace('T', ' '); // Formats to YYYY-MM-DD HH:MM:SS\n      }\n  }\n}, {\n    timestamps: true, // This will add createdAt and updatedAt fields automatically\n    toJSON: { getters: true }, // This ensures the getter for createdAt is used when converting to JSON\n});\n\n// Add a virtual to store numeric price without currency\nproductSchema.virtual('numericPrice').get(function () {\n  const numericValue = this.price.replace(/[^0-9.]/g, ''); // Extract numeric value\n  return parseFloat(numericValue) || 0;\n});\n\n// Create and export the Product model\nconst Product = mongoose.model('Product', productSchema);\n\nexport default Product;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAmC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEnC,MAAMG,aAAa,GAAG,IAAIC,iBAAQ,CAACC,MAAM,CAAC;EACxCC,EAAE,EAAE;IACAC,IAAI,EAAEC,MAAM;IACZN,OAAO,EAAEA,CAAA,KAAM,IAAIO,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;IAAE;IACzCC,MAAM,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACPL,IAAI,EAAEC,MAAM;IACZN,OAAO,EAAE,eAAe,CAAC;EAC7B,CAAC;EACDW,IAAI,EAAE;IAAEN,IAAI,EAAEC,MAAM;IAAEM,QAAQ,EAAE;EAAK,CAAC;EACtCC,KAAK,EAAE;IAAER,IAAI,EAAES,MAAM;IAAEF,QAAQ,EAAE;EAAK,CAAC;EACvCG,WAAW,EAAE;IAAEV,IAAI,EAAEC;EAAO,CAAC;EAC7BU,QAAQ,EAAE;IAAEX,IAAI,EAAEY,OAAO;IAAEjB,OAAO,EAAE;EAAM,CAAC;EAC3CkB,KAAK,EAAE;IAAEb,IAAI,EAAEC,MAAM;IAAEM,QAAQ,EAAE;EAAK,CAAC;EACvCO,KAAK,EAAE;IAAEd,IAAI,EAAES,MAAM;IAAEF,QAAQ,EAAE,IAAI;IAAEQ,GAAG,EAAE;EAAE,CAAC;EAC/CC,SAAS,EAAE;IACPhB,IAAI,EAAEE,IAAI;IACVP,OAAO,EAAEO,IAAI,CAACe,GAAG;IACjBC,GAAG,EAAE,SAAAA,CAASC,IAAI,EAAE;MAChB,OAAOA,IAAI,CAAChB,WAAW,CAAC,CAAC,CAACiB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IAC9D;EACJ;AACF,CAAC,EAAE;EACCC,UAAU,EAAE,IAAI;EAAE;EAClBC,MAAM,EAAE;IAAEC,OAAO,EAAE;EAAK,CAAC,CAAE;AAC/B,CAAC,CAAC;;AAEF;AACA5B,aAAa,CAAC6B,OAAO,CAAC,cAAc,CAAC,CAACP,GAAG,CAAC,YAAY;EACpD,MAAMQ,YAAY,GAAG,IAAI,CAAClB,KAAK,CAACa,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,CAAC;EACzD,OAAOM,UAAU,CAACD,YAAY,CAAC,IAAI,CAAC;AACtC,CAAC,CAAC;;AAEF;AACA,MAAME,OAAO,GAAG/B,iBAAQ,CAACgC,KAAK,CAAC,SAAS,EAAEjC,aAAa,CAAC;AAAC,IAAAkC,QAAA,GAAAC,OAAA,CAAApC,OAAA,GAE1CiC,OAAO","ignoreList":[]}},"mtime":1737637018985},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/verifyAdmin.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst verifyAdmin = (req, res, next) => {\n  const token = req.headers[\"authorization\"];\n  if (!token) return res.status(403).json({\n    message: \"No token provided\"\n  });\n  _jsonwebtoken.default.verify(token, process.env.JWT_SECRET, (err, decoded) => {\n    if (err) return res.status(401).json({\n      message: \"Unauthorized\"\n    });\n    if (!decoded.isAdmin) {\n      return res.status(403).json({\n        message: \"Admin privileges required\"\n      });\n    }\n    req.userId = decoded.id;\n    next();\n  });\n};\nvar _default = exports.default = verifyAdmin;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfanNvbndlYnRva2VuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ2ZXJpZnlBZG1pbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImhlYWRlcnMiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImp3dCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXJyIiwiZGVjb2RlZCIsImlzQWRtaW4iLCJ1c2VySWQiLCJpZCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvcHVycGxlX3F1YXNhci9BTFhfU0UvYWx4LXdlYnN0YWNrLXBvcnRmb2xpby1wcm9qZWN0L2FuY2hvci1lLWNvbW1lcmNlLXNpdGUvYmFja2VuZC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJ2ZXJpZnlBZG1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcblxuY29uc3QgdmVyaWZ5QWRtaW4gPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXTtcbiAgICBpZiAoIXRva2VuKSByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBtZXNzYWdlOiBcIk5vIHRva2VuIHByb3ZpZGVkXCIgfSk7XG5cbiAgICBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCAoZXJyLCBkZWNvZGVkKSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6IFwiVW5hdXRob3JpemVkXCIgfSk7XG5cbiAgICAgICAgaWYgKCFkZWNvZGVkLmlzQWRtaW4pIHtcbiAgICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgICAgICAuc3RhdHVzKDQwMylcbiAgICAgICAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiQWRtaW4gcHJpdmlsZWdlcyByZXF1aXJlZFwiIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVxLnVzZXJJZCA9IGRlY29kZWQuaWQ7XG4gICAgICAgIG5leHQoKTtcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHZlcmlmeUFkbWluO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxhQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsV0FBVyxHQUFHQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ3BDLE1BQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUMsZUFBZSxDQUFDO0VBQzFDLElBQUksQ0FBQ0QsS0FBSyxFQUFFLE9BQU9GLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFBRUMsT0FBTyxFQUFFO0VBQW9CLENBQUMsQ0FBQztFQUV6RUMscUJBQUcsQ0FBQ0MsTUFBTSxDQUFDTixLQUFLLEVBQUVPLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUUsQ0FBQ0MsR0FBRyxFQUFFQyxPQUFPLEtBQUs7SUFDeEQsSUFBSUQsR0FBRyxFQUFFLE9BQU9aLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQWUsQ0FBQyxDQUFDO0lBRWpFLElBQUksQ0FBQ08sT0FBTyxDQUFDQyxPQUFPLEVBQUU7TUFDbEIsT0FBT2QsR0FBRyxDQUNMSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQ1hDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUU7TUFBNEIsQ0FBQyxDQUFDO0lBQ3ZEO0lBRUFQLEdBQUcsQ0FBQ2dCLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxFQUFFO0lBQ3ZCZixJQUFJLENBQUMsQ0FBQztFQUNWLENBQUMsQ0FBQztBQUNOLENBQUM7QUFBQyxJQUFBZ0IsUUFBQSxHQUFBQyxPQUFBLENBQUFyQixPQUFBLEdBRWFDLFdBQVciLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_jsonwebtoken","_interopRequireDefault","require","e","__esModule","default","verifyAdmin","req","res","next","token","headers","status","json","message","jwt","verify","process","env","JWT_SECRET","err","decoded","isAdmin","userId","id","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/","sources":["verifyAdmin.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nconst verifyAdmin = (req, res, next) => {\n    const token = req.headers[\"authorization\"];\n    if (!token) return res.status(403).json({ message: \"No token provided\" });\n\n    jwt.verify(token, process.env.JWT_SECRET, (err, decoded) => {\n        if (err) return res.status(401).json({ message: \"Unauthorized\" });\n\n        if (!decoded.isAdmin) {\n            return res\n                .status(403)\n                .json({ message: \"Admin privileges required\" });\n        }\n\n        req.userId = decoded.id;\n        next();\n    });\n};\n\nexport default verifyAdmin;\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,WAAW,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACpC,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAAC,eAAe,CAAC;EAC1C,IAAI,CAACD,KAAK,EAAE,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAoB,CAAC,CAAC;EAEzEC,qBAAG,CAACC,MAAM,CAACN,KAAK,EAAEO,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE,CAACC,GAAG,EAAEC,OAAO,KAAK;IACxD,IAAID,GAAG,EAAE,OAAOZ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAe,CAAC,CAAC;IAEjE,IAAI,CAACO,OAAO,CAACC,OAAO,EAAE;MAClB,OAAOd,GAAG,CACLI,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA4B,CAAC,CAAC;IACvD;IAEAP,GAAG,CAACgB,MAAM,GAAGF,OAAO,CAACG,EAAE;IACvBf,IAAI,CAAC,CAAC;EACV,CAAC,CAAC;AACN,CAAC;AAAC,IAAAgB,QAAA,GAAAC,OAAA,CAAArB,OAAA,GAEaC,WAAW","ignoreList":[]}},"mtime":1737803311435},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _argon = _interopRequireDefault(require(\"argon2\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Import argon2 instead of bcryptjs\n\nconst UserSchema = new _mongoose.default.Schema({\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  username: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  isAdmin: {\n    type: Boolean,\n    default: false\n  }\n});\n\n// Pre-save hook to hash password before saving it to the database\nUserSchema.pre(\"save\", async function (next) {\n  if (!this.isModified(\"password\")) return next(); // Only hash password if it's modified\n\n  try {\n    // Hash the password using Argon2\n    this.password = await _argon.default.hash(this.password, {\n      type: _argon.default.argon2id,\n      // Use the argon2id variant\n      memoryCost: 65536,\n      // 64MB of memory\n      timeCost: 3,\n      // 3 iterations\n      parallelism: 4 // 4 parallel threads\n    });\n    next();\n  } catch (error) {\n    next(error);\n  }\n});\nvar _default = exports.default = _mongoose.default.model(\"User\", UserSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hcmdvbiIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlVzZXJTY2hlbWEiLCJtb25nb29zZSIsIlNjaGVtYSIsImVtYWlsIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidW5pcXVlIiwicGFzc3dvcmQiLCJ1c2VybmFtZSIsImlzQWRtaW4iLCJCb29sZWFuIiwicHJlIiwibmV4dCIsImlzTW9kaWZpZWQiLCJhcmdvbjIiLCJoYXNoIiwiYXJnb24yaWQiLCJtZW1vcnlDb3N0IiwidGltZUNvc3QiLCJwYXJhbGxlbGlzbSIsImVycm9yIiwiX2RlZmF1bHQiLCJleHBvcnRzIiwibW9kZWwiXSwic291cmNlUm9vdCI6Ii9ob21lL3B1cnBsZV9xdWFzYXIvQUxYX1NFL2FseC13ZWJzdGFjay1wb3J0Zm9saW8tcHJvamVjdC9hbmNob3ItZS1jb21tZXJjZS1zaXRlL2JhY2tlbmQvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGFyZ29uMiBmcm9tIFwiYXJnb24yXCI7IC8vIEltcG9ydCBhcmdvbjIgaW5zdGVhZCBvZiBiY3J5cHRqc1xuXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICBwYXNzd29yZDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIHVzZXJuYW1lOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICBpc0FkbWluOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sXG59KTtcblxuLy8gUHJlLXNhdmUgaG9vayB0byBoYXNoIHBhc3N3b3JkIGJlZm9yZSBzYXZpbmcgaXQgdG8gdGhlIGRhdGFiYXNlXG5Vc2VyU2NoZW1hLnByZShcInNhdmVcIiwgYXN5bmMgZnVuY3Rpb24gKG5leHQpIHtcbiAgaWYgKCF0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkgcmV0dXJuIG5leHQoKTsgLy8gT25seSBoYXNoIHBhc3N3b3JkIGlmIGl0J3MgbW9kaWZpZWRcblxuICB0cnkge1xuICAgIC8vIEhhc2ggdGhlIHBhc3N3b3JkIHVzaW5nIEFyZ29uMlxuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBhcmdvbjIuaGFzaCh0aGlzLnBhc3N3b3JkLCB7XG4gICAgICB0eXBlOiBhcmdvbjIuYXJnb24yaWQsICAvLyBVc2UgdGhlIGFyZ29uMmlkIHZhcmlhbnRcbiAgICAgIG1lbW9yeUNvc3Q6IDY1NTM2LCAgICAgICAvLyA2NE1CIG9mIG1lbW9yeVxuICAgICAgdGltZUNvc3Q6IDMsICAgICAgICAgICAgIC8vIDMgaXRlcmF0aW9uc1xuICAgICAgcGFyYWxsZWxpc206IDQgICAgICAgICAgIC8vIDQgcGFyYWxsZWwgdGhyZWFkc1xuICAgIH0pO1xuICAgIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IG1vbmdvb3NlLm1vZGVsKFwiVXNlclwiLCBVc2VyU2NoZW1hKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsTUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQTRCLFNBQUFELHVCQUFBRyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUM7O0FBRTdCLE1BQU1HLFVBQVUsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDckNDLEtBQUssRUFBRTtJQUFFQyxJQUFJLEVBQUVDLE1BQU07SUFBRUMsUUFBUSxFQUFFLElBQUk7SUFBRUMsTUFBTSxFQUFFO0VBQUssQ0FBQztFQUNyREMsUUFBUSxFQUFFO0lBQUVKLElBQUksRUFBRUMsTUFBTTtJQUFFQyxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQzFDRyxRQUFRLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFNO0lBQUVDLFFBQVEsRUFBRSxJQUFJO0lBQUVDLE1BQU0sRUFBRTtFQUFLLENBQUM7RUFDeERHLE9BQU8sRUFBRTtJQUFFTixJQUFJLEVBQUVPLE9BQU87SUFBRVosT0FBTyxFQUFFO0VBQU07QUFDM0MsQ0FBQyxDQUFDOztBQUVGO0FBQ0FDLFVBQVUsQ0FBQ1ksR0FBRyxDQUFDLE1BQU0sRUFBRSxnQkFBZ0JDLElBQUksRUFBRTtFQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsT0FBT0QsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDOztFQUVqRCxJQUFJO0lBQ0Y7SUFDQSxJQUFJLENBQUNMLFFBQVEsR0FBRyxNQUFNTyxjQUFNLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUNSLFFBQVEsRUFBRTtNQUMvQ0osSUFBSSxFQUFFVyxjQUFNLENBQUNFLFFBQVE7TUFBRztNQUN4QkMsVUFBVSxFQUFFLEtBQUs7TUFBUTtNQUN6QkMsUUFBUSxFQUFFLENBQUM7TUFBYztNQUN6QkMsV0FBVyxFQUFFLENBQUMsQ0FBVztJQUMzQixDQUFDLENBQUM7SUFDRlAsSUFBSSxDQUFDLENBQUM7RUFDUixDQUFDLENBQUMsT0FBT1EsS0FBSyxFQUFFO0lBQ2RSLElBQUksQ0FBQ1EsS0FBSyxDQUFDO0VBQ2I7QUFDRixDQUFDLENBQUM7QUFBQyxJQUFBQyxRQUFBLEdBQUFDLE9BQUEsQ0FBQXhCLE9BQUEsR0FFWUUsaUJBQVEsQ0FBQ3VCLEtBQUssQ0FBQyxNQUFNLEVBQUV4QixVQUFVLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_argon","e","__esModule","default","UserSchema","mongoose","Schema","email","type","String","required","unique","password","username","isAdmin","Boolean","pre","next","isModified","argon2","hash","argon2id","memoryCost","timeCost","parallelism","error","_default","exports","model"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/","sources":["User.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport argon2 from \"argon2\"; // Import argon2 instead of bcryptjs\n\nconst UserSchema = new mongoose.Schema({\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n  username: { type: String, required: true, unique: true },\n  isAdmin: { type: Boolean, default: false },\n});\n\n// Pre-save hook to hash password before saving it to the database\nUserSchema.pre(\"save\", async function (next) {\n  if (!this.isModified(\"password\")) return next(); // Only hash password if it's modified\n\n  try {\n    // Hash the password using Argon2\n    this.password = await argon2.hash(this.password, {\n      type: argon2.argon2id,  // Use the argon2id variant\n      memoryCost: 65536,       // 64MB of memory\n      timeCost: 3,             // 3 iterations\n      parallelism: 4           // 4 parallel threads\n    });\n    next();\n  } catch (error) {\n    next(error);\n  }\n});\n\nexport default mongoose.model(\"User\", UserSchema);\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,MAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAC;;AAE7B,MAAMG,UAAU,GAAG,IAAIC,iBAAQ,CAACC,MAAM,CAAC;EACrCC,KAAK,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC;EACrDC,QAAQ,EAAE;IAAEJ,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAK,CAAC;EAC1CG,QAAQ,EAAE;IAAEL,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC;EACxDG,OAAO,EAAE;IAAEN,IAAI,EAAEO,OAAO;IAAEZ,OAAO,EAAE;EAAM;AAC3C,CAAC,CAAC;;AAEF;AACAC,UAAU,CAACY,GAAG,CAAC,MAAM,EAAE,gBAAgBC,IAAI,EAAE;EAC3C,IAAI,CAAC,IAAI,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE,OAAOD,IAAI,CAAC,CAAC,CAAC,CAAC;;EAEjD,IAAI;IACF;IACA,IAAI,CAACL,QAAQ,GAAG,MAAMO,cAAM,CAACC,IAAI,CAAC,IAAI,CAACR,QAAQ,EAAE;MAC/CJ,IAAI,EAAEW,cAAM,CAACE,QAAQ;MAAG;MACxBC,UAAU,EAAE,KAAK;MAAQ;MACzBC,QAAQ,EAAE,CAAC;MAAc;MACzBC,WAAW,EAAE,CAAC,CAAW;IAC3B,CAAC,CAAC;IACFP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOQ,KAAK,EAAE;IACdR,IAAI,CAACQ,KAAK,CAAC;EACb;AACF,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAxB,OAAA,GAEYE,iBAAQ,CAACuB,KAAK,CAAC,MAAM,EAAExB,UAAU,CAAC","ignoreList":[]}},"mtime":1737829755160},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _Product = _interopRequireDefault(require(\"../models/Product.js\"));\nvar _verifyAdmin = _interopRequireDefault(require(\"../middlewares/verifyAdmin.js\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst router = _express.default.Router();\nrouter.post(\"/admin/product\", _verifyAdmin.default, async (req, res) => {\n  const {\n    name,\n    description,\n    price,\n    category\n  } = req.body;\n  try {\n    const newProduct = new _Product.default({\n      name,\n      description,\n      price,\n      category\n    });\n    await newProduct.save();\n    res.status(201).json({\n      message: \"Product added successfully\"\n    });\n  } catch (error) {\n    res.status(500).json({\n      message: \"Server error\"\n    });\n  }\n});\nvar _default = exports.default = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX1Byb2R1Y3QiLCJfdmVyaWZ5QWRtaW4iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJyb3V0ZXIiLCJleHByZXNzIiwiUm91dGVyIiwicG9zdCIsInZlcmlmeUFkbWluIiwicmVxIiwicmVzIiwibmFtZSIsImRlc2NyaXB0aW9uIiwicHJpY2UiLCJjYXRlZ29yeSIsImJvZHkiLCJuZXdQcm9kdWN0IiwiUHJvZHVjdCIsInNhdmUiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVycm9yIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJwcm9kdWN0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IFByb2R1Y3QgZnJvbSBcIi4uL21vZGVscy9Qcm9kdWN0LmpzXCI7XG5pbXBvcnQgdmVyaWZ5QWRtaW4gZnJvbSBcIi4uL21pZGRsZXdhcmVzL3ZlcmlmeUFkbWluLmpzXCI7XG5cbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbnJvdXRlci5wb3N0KFwiL2FkbWluL3Byb2R1Y3RcIiwgdmVyaWZ5QWRtaW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBjYXRlZ29yeSB9ID0gcmVxLmJvZHk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBuZXdQcm9kdWN0ID0gbmV3IFByb2R1Y3QoeyBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGNhdGVnb3J5IH0pO1xuICAgICAgICBhd2FpdCBuZXdQcm9kdWN0LnNhdmUoKTtcbiAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBtZXNzYWdlOiBcIlByb2R1Y3QgYWRkZWQgc3VjY2Vzc2Z1bGx5XCIgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBcIlNlcnZlciBlcnJvclwiIH0pO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFlBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3RCxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUV4RCxNQUFNRyxNQUFNLEdBQUdDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBRS9CRixNQUFNLENBQUNHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRUMsb0JBQVcsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMzRCxNQUFNO0lBQUVDLElBQUk7SUFBRUMsV0FBVztJQUFFQyxLQUFLO0lBQUVDO0VBQVMsQ0FBQyxHQUFHTCxHQUFHLENBQUNNLElBQUk7RUFFdkQsSUFBSTtJQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJQyxnQkFBTyxDQUFDO01BQUVOLElBQUk7TUFBRUMsV0FBVztNQUFFQyxLQUFLO01BQUVDO0lBQVMsQ0FBQyxDQUFDO0lBQ3RFLE1BQU1FLFVBQVUsQ0FBQ0UsSUFBSSxDQUFDLENBQUM7SUFDdkJSLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQTZCLENBQUMsQ0FBQztFQUNuRSxDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO0lBQ1paLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQWUsQ0FBQyxDQUFDO0VBQ3JEO0FBQ0osQ0FBQyxDQUFDO0FBQUMsSUFBQUUsUUFBQSxHQUFBQyxPQUFBLENBQUFyQixPQUFBLEdBRVlDLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_express","_interopRequireDefault","require","_Product","_verifyAdmin","e","__esModule","default","router","express","Router","post","verifyAdmin","req","res","name","description","price","category","body","newProduct","Product","save","status","json","message","error","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/routes/","sources":["products.js"],"sourcesContent":["import express from \"express\";\nimport Product from \"../models/Product.js\";\nimport verifyAdmin from \"../middlewares/verifyAdmin.js\";\n\nconst router = express.Router();\n\nrouter.post(\"/admin/product\", verifyAdmin, async (req, res) => {\n    const { name, description, price, category } = req.body;\n\n    try {\n        const newProduct = new Product({ name, description, price, category });\n        await newProduct.save();\n        res.status(201).json({ message: \"Product added successfully\" });\n    } catch (error) {\n        res.status(500).json({ message: \"Server error\" });\n    }\n});\n\nexport default router;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,YAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAwD,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAExD,MAAMG,MAAM,GAAGC,gBAAO,CAACC,MAAM,CAAC,CAAC;AAE/BF,MAAM,CAACG,IAAI,CAAC,gBAAgB,EAAEC,oBAAW,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC3D,MAAM;IAAEC,IAAI;IAAEC,WAAW;IAAEC,KAAK;IAAEC;EAAS,CAAC,GAAGL,GAAG,CAACM,IAAI;EAEvD,IAAI;IACA,MAAMC,UAAU,GAAG,IAAIC,gBAAO,CAAC;MAAEN,IAAI;MAAEC,WAAW;MAAEC,KAAK;MAAEC;IAAS,CAAC,CAAC;IACtE,MAAME,UAAU,CAACE,IAAI,CAAC,CAAC;IACvBR,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA6B,CAAC,CAAC;EACnE,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZZ,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAe,CAAC,CAAC;EACrD;AACJ,CAAC,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAArB,OAAA,GAEYC,MAAM","ignoreList":[]}},"mtime":1737804265184},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/Product.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _shortUuid = _interopRequireDefault(require(\"short-uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst productSchema = new _mongoose.default.Schema({\n  id: {\n    type: String,\n    default: () => new Date().toISOString(),\n    // This will create a timestamp in ISO format\n    unique: true\n  },\n  createdBy: {\n    type: String,\n    default: 'shiftyshadows' // Current user's login\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  description: {\n    type: String\n  },\n  featured: {\n    type: Boolean,\n    default: false\n  },\n  image: {\n    type: String,\n    required: true\n  },\n  stock: {\n    type: Number,\n    required: true,\n    min: 0\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n    get: function (date) {\n      return date.toISOString().slice(0, 19).replace('T', ' '); // Formats to YYYY-MM-DD HH:MM:SS\n    }\n  }\n}, {\n  timestamps: true,\n  // This will add createdAt and updatedAt fields automatically\n  toJSON: {\n    getters: true\n  } // This ensures the getter for createdAt is used when converting to JSON\n});\n\n// Add a virtual to store numeric price without currency\nproductSchema.virtual('numericPrice').get(function () {\n  const numericValue = this.price.replace(/[^0-9.]/g, ''); // Extract numeric value\n  return parseFloat(numericValue) || 0;\n});\n\n// Create and export the Product model\nconst Product = _mongoose.default.model('Product', productSchema);\nvar _default = exports.default = Product;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9zaG9ydFV1aWQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJwcm9kdWN0U2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJpZCIsInR5cGUiLCJTdHJpbmciLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1bmlxdWUiLCJjcmVhdGVkQnkiLCJuYW1lIiwicmVxdWlyZWQiLCJwcmljZSIsIk51bWJlciIsImRlc2NyaXB0aW9uIiwiZmVhdHVyZWQiLCJCb29sZWFuIiwiaW1hZ2UiLCJzdG9jayIsIm1pbiIsImNyZWF0ZWRBdCIsIm5vdyIsImdldCIsImRhdGUiLCJzbGljZSIsInJlcGxhY2UiLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwiZ2V0dGVycyIsInZpcnR1YWwiLCJudW1lcmljVmFsdWUiLCJwYXJzZUZsb2F0IiwiUHJvZHVjdCIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9wdXJwbGVfcXVhc2FyL0FMWF9TRS9hbHgtd2Vic3RhY2stcG9ydGZvbGlvLXByb2plY3QvYW5jaG9yLWUtY29tbWVyY2Utc2l0ZS9iYWNrZW5kL3NyYy9tb2RlbHMvIiwic291cmNlcyI6WyJQcm9kdWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgU2hvcnRVVUlEIGZyb20gJ3Nob3J0LXV1aWQnO1xuXG5jb25zdCBwcm9kdWN0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIGlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAoKSA9PiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIC8vIFRoaXMgd2lsbCBjcmVhdGUgYSB0aW1lc3RhbXAgaW4gSVNPIGZvcm1hdFxuICAgICAgdW5pcXVlOiB0cnVlXG4gIH0sXG4gIGNyZWF0ZWRCeToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogJ3NoaWZ0eXNoYWRvd3MnIC8vIEN1cnJlbnQgdXNlcidzIGxvZ2luXG4gIH0sXG4gIG5hbWU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICBwcmljZTogeyB0eXBlOiBOdW1iZXIsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIGRlc2NyaXB0aW9uOiB7IHR5cGU6IFN0cmluZyB9LFxuICBmZWF0dXJlZDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxuICBpbWFnZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gIHN0b2NrOiB7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUsIG1pbjogMCB9LFxuICBjcmVhdGVkQXQ6IHtcbiAgICAgIHR5cGU6IERhdGUsXG4gICAgICBkZWZhdWx0OiBEYXRlLm5vdyxcbiAgICAgIGdldDogZnVuY3Rpb24oZGF0ZSkge1xuICAgICAgICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoJ1QnLCAnICcpOyAvLyBGb3JtYXRzIHRvIFlZWVktTU0tREQgSEg6TU06U1NcbiAgICAgIH1cbiAgfVxufSwge1xuICAgIHRpbWVzdGFtcHM6IHRydWUsIC8vIFRoaXMgd2lsbCBhZGQgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgZmllbGRzIGF1dG9tYXRpY2FsbHlcbiAgICB0b0pTT046IHsgZ2V0dGVyczogdHJ1ZSB9LCAvLyBUaGlzIGVuc3VyZXMgdGhlIGdldHRlciBmb3IgY3JlYXRlZEF0IGlzIHVzZWQgd2hlbiBjb252ZXJ0aW5nIHRvIEpTT05cbn0pO1xuXG4vLyBBZGQgYSB2aXJ0dWFsIHRvIHN0b3JlIG51bWVyaWMgcHJpY2Ugd2l0aG91dCBjdXJyZW5jeVxucHJvZHVjdFNjaGVtYS52aXJ0dWFsKCdudW1lcmljUHJpY2UnKS5nZXQoZnVuY3Rpb24gKCkge1xuICBjb25zdCBudW1lcmljVmFsdWUgPSB0aGlzLnByaWNlLnJlcGxhY2UoL1teMC05Ll0vZywgJycpOyAvLyBFeHRyYWN0IG51bWVyaWMgdmFsdWVcbiAgcmV0dXJuIHBhcnNlRmxvYXQobnVtZXJpY1ZhbHVlKSB8fCAwO1xufSk7XG5cbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSBQcm9kdWN0IG1vZGVsXG5jb25zdCBQcm9kdWN0ID0gbW9uZ29vc2UubW9kZWwoJ1Byb2R1Y3QnLCBwcm9kdWN0U2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgUHJvZHVjdDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQW1DLFNBQUFELHVCQUFBRyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRW5DLE1BQU1HLGFBQWEsR0FBRyxJQUFJQyxpQkFBUSxDQUFDQyxNQUFNLENBQUM7RUFDeENDLEVBQUUsRUFBRTtJQUNBQyxJQUFJLEVBQUVDLE1BQU07SUFDWk4sT0FBTyxFQUFFQSxDQUFBLEtBQU0sSUFBSU8sSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7SUFBRTtJQUN6Q0MsTUFBTSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDUEwsSUFBSSxFQUFFQyxNQUFNO0lBQ1pOLE9BQU8sRUFBRSxlQUFlLENBQUM7RUFDN0IsQ0FBQztFQUNEVyxJQUFJLEVBQUU7SUFBRU4sSUFBSSxFQUFFQyxNQUFNO0lBQUVNLFFBQVEsRUFBRTtFQUFLLENBQUM7RUFDdENDLEtBQUssRUFBRTtJQUFFUixJQUFJLEVBQUVTLE1BQU07SUFBRUYsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUN2Q0csV0FBVyxFQUFFO0lBQUVWLElBQUksRUFBRUM7RUFBTyxDQUFDO0VBQzdCVSxRQUFRLEVBQUU7SUFBRVgsSUFBSSxFQUFFWSxPQUFPO0lBQUVqQixPQUFPLEVBQUU7RUFBTSxDQUFDO0VBQzNDa0IsS0FBSyxFQUFFO0lBQUViLElBQUksRUFBRUMsTUFBTTtJQUFFTSxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQ3ZDTyxLQUFLLEVBQUU7SUFBRWQsSUFBSSxFQUFFUyxNQUFNO0lBQUVGLFFBQVEsRUFBRSxJQUFJO0lBQUVRLEdBQUcsRUFBRTtFQUFFLENBQUM7RUFDL0NDLFNBQVMsRUFBRTtJQUNQaEIsSUFBSSxFQUFFRSxJQUFJO0lBQ1ZQLE9BQU8sRUFBRU8sSUFBSSxDQUFDZSxHQUFHO0lBQ2pCQyxHQUFHLEVBQUUsU0FBQUEsQ0FBU0MsSUFBSSxFQUFFO01BQ2hCLE9BQU9BLElBQUksQ0FBQ2hCLFdBQVcsQ0FBQyxDQUFDLENBQUNpQixLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDOUQ7RUFDSjtBQUNGLENBQUMsRUFBRTtFQUNDQyxVQUFVLEVBQUUsSUFBSTtFQUFFO0VBQ2xCQyxNQUFNLEVBQUU7SUFBRUMsT0FBTyxFQUFFO0VBQUssQ0FBQyxDQUFFO0FBQy9CLENBQUMsQ0FBQzs7QUFFRjtBQUNBNUIsYUFBYSxDQUFDNkIsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDUCxHQUFHLENBQUMsWUFBWTtFQUNwRCxNQUFNUSxZQUFZLEdBQUcsSUFBSSxDQUFDbEIsS0FBSyxDQUFDYSxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7RUFDekQsT0FBT00sVUFBVSxDQUFDRCxZQUFZLENBQUMsSUFBSSxDQUFDO0FBQ3RDLENBQUMsQ0FBQzs7QUFFRjtBQUNBLE1BQU1FLE9BQU8sR0FBRy9CLGlCQUFRLENBQUNnQyxLQUFLLENBQUMsU0FBUyxFQUFFakMsYUFBYSxDQUFDO0FBQUMsSUFBQWtDLFFBQUEsR0FBQUMsT0FBQSxDQUFBcEMsT0FBQSxHQUUxQ2lDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_shortUuid","e","__esModule","default","productSchema","mongoose","Schema","id","type","String","Date","toISOString","unique","createdBy","name","required","price","Number","description","featured","Boolean","image","stock","min","createdAt","now","get","date","slice","replace","timestamps","toJSON","getters","virtual","numericValue","parseFloat","Product","model","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/models/","sources":["Product.js"],"sourcesContent":["import mongoose from 'mongoose';\nimport ShortUUID from 'short-uuid';\n\nconst productSchema = new mongoose.Schema({\n  id: {\n      type: String,\n      default: () => new Date().toISOString(), // This will create a timestamp in ISO format\n      unique: true\n  },\n  createdBy: {\n      type: String,\n      default: 'shiftyshadows' // Current user's login\n  },\n  name: { type: String, required: true },\n  price: { type: Number, required: true },\n  description: { type: String },\n  featured: { type: Boolean, default: false },\n  image: { type: String, required: true },\n  stock: { type: Number, required: true, min: 0 },\n  createdAt: {\n      type: Date,\n      default: Date.now,\n      get: function(date) {\n          return date.toISOString().slice(0, 19).replace('T', ' '); // Formats to YYYY-MM-DD HH:MM:SS\n      }\n  }\n}, {\n    timestamps: true, // This will add createdAt and updatedAt fields automatically\n    toJSON: { getters: true }, // This ensures the getter for createdAt is used when converting to JSON\n});\n\n// Add a virtual to store numeric price without currency\nproductSchema.virtual('numericPrice').get(function () {\n  const numericValue = this.price.replace(/[^0-9.]/g, ''); // Extract numeric value\n  return parseFloat(numericValue) || 0;\n});\n\n// Create and export the Product model\nconst Product = mongoose.model('Product', productSchema);\n\nexport default Product;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAmC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEnC,MAAMG,aAAa,GAAG,IAAIC,iBAAQ,CAACC,MAAM,CAAC;EACxCC,EAAE,EAAE;IACAC,IAAI,EAAEC,MAAM;IACZN,OAAO,EAAEA,CAAA,KAAM,IAAIO,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;IAAE;IACzCC,MAAM,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACPL,IAAI,EAAEC,MAAM;IACZN,OAAO,EAAE,eAAe,CAAC;EAC7B,CAAC;EACDW,IAAI,EAAE;IAAEN,IAAI,EAAEC,MAAM;IAAEM,QAAQ,EAAE;EAAK,CAAC;EACtCC,KAAK,EAAE;IAAER,IAAI,EAAES,MAAM;IAAEF,QAAQ,EAAE;EAAK,CAAC;EACvCG,WAAW,EAAE;IAAEV,IAAI,EAAEC;EAAO,CAAC;EAC7BU,QAAQ,EAAE;IAAEX,IAAI,EAAEY,OAAO;IAAEjB,OAAO,EAAE;EAAM,CAAC;EAC3CkB,KAAK,EAAE;IAAEb,IAAI,EAAEC,MAAM;IAAEM,QAAQ,EAAE;EAAK,CAAC;EACvCO,KAAK,EAAE;IAAEd,IAAI,EAAES,MAAM;IAAEF,QAAQ,EAAE,IAAI;IAAEQ,GAAG,EAAE;EAAE,CAAC;EAC/CC,SAAS,EAAE;IACPhB,IAAI,EAAEE,IAAI;IACVP,OAAO,EAAEO,IAAI,CAACe,GAAG;IACjBC,GAAG,EAAE,SAAAA,CAASC,IAAI,EAAE;MAChB,OAAOA,IAAI,CAAChB,WAAW,CAAC,CAAC,CAACiB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IAC9D;EACJ;AACF,CAAC,EAAE;EACCC,UAAU,EAAE,IAAI;EAAE;EAClBC,MAAM,EAAE;IAAEC,OAAO,EAAE;EAAK,CAAC,CAAE;AAC/B,CAAC,CAAC;;AAEF;AACA5B,aAAa,CAAC6B,OAAO,CAAC,cAAc,CAAC,CAACP,GAAG,CAAC,YAAY;EACpD,MAAMQ,YAAY,GAAG,IAAI,CAAClB,KAAK,CAACa,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,CAAC;EACzD,OAAOM,UAAU,CAACD,YAAY,CAAC,IAAI,CAAC;AACtC,CAAC,CAAC;;AAEF;AACA,MAAME,OAAO,GAAG/B,iBAAQ,CAACgC,KAAK,CAAC,SAAS,EAAEjC,aAAa,CAAC;AAAC,IAAAkC,QAAA,GAAAC,OAAA,CAAApC,OAAA,GAE1CiC,OAAO","ignoreList":[]}},"mtime":1737637018985},"{\"assumptions\":{},\"sourceRoot\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"filename\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/verifyAdmin.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$2\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$15\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.0:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst verifyAdmin = (req, res, next) => {\n  const token = req.headers[\"authorization\"];\n  if (!token) return res.status(403).json({\n    message: \"No token provided\"\n  });\n  _jsonwebtoken.default.verify(token, process.env.JWT_SECRET, (err, decoded) => {\n    if (err) return res.status(401).json({\n      message: \"Unauthorized\"\n    });\n    if (!decoded.isAdmin) {\n      return res.status(403).json({\n        message: \"Admin privileges required\"\n      });\n    }\n    req.userId = decoded.id;\n    next();\n  });\n};\nvar _default = exports.default = verifyAdmin;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfanNvbndlYnRva2VuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ2ZXJpZnlBZG1pbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImhlYWRlcnMiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImp3dCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXJyIiwiZGVjb2RlZCIsImlzQWRtaW4iLCJ1c2VySWQiLCJpZCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvcHVycGxlX3F1YXNhci9BTFhfU0UvYWx4LXdlYnN0YWNrLXBvcnRmb2xpby1wcm9qZWN0L2FuY2hvci1lLWNvbW1lcmNlLXNpdGUvYmFja2VuZC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJ2ZXJpZnlBZG1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcblxuY29uc3QgdmVyaWZ5QWRtaW4gPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXTtcbiAgICBpZiAoIXRva2VuKSByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBtZXNzYWdlOiBcIk5vIHRva2VuIHByb3ZpZGVkXCIgfSk7XG5cbiAgICBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCAoZXJyLCBkZWNvZGVkKSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6IFwiVW5hdXRob3JpemVkXCIgfSk7XG5cbiAgICAgICAgaWYgKCFkZWNvZGVkLmlzQWRtaW4pIHtcbiAgICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgICAgICAuc3RhdHVzKDQwMylcbiAgICAgICAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiQWRtaW4gcHJpdmlsZWdlcyByZXF1aXJlZFwiIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVxLnVzZXJJZCA9IGRlY29kZWQuaWQ7XG4gICAgICAgIG5leHQoKTtcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHZlcmlmeUFkbWluO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxhQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsV0FBVyxHQUFHQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ3BDLE1BQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUMsZUFBZSxDQUFDO0VBQzFDLElBQUksQ0FBQ0QsS0FBSyxFQUFFLE9BQU9GLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFBRUMsT0FBTyxFQUFFO0VBQW9CLENBQUMsQ0FBQztFQUV6RUMscUJBQUcsQ0FBQ0MsTUFBTSxDQUFDTixLQUFLLEVBQUVPLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUUsQ0FBQ0MsR0FBRyxFQUFFQyxPQUFPLEtBQUs7SUFDeEQsSUFBSUQsR0FBRyxFQUFFLE9BQU9aLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQWUsQ0FBQyxDQUFDO0lBRWpFLElBQUksQ0FBQ08sT0FBTyxDQUFDQyxPQUFPLEVBQUU7TUFDbEIsT0FBT2QsR0FBRyxDQUNMSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQ1hDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUU7TUFBNEIsQ0FBQyxDQUFDO0lBQ3ZEO0lBRUFQLEdBQUcsQ0FBQ2dCLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxFQUFFO0lBQ3ZCZixJQUFJLENBQUMsQ0FBQztFQUNWLENBQUMsQ0FBQztBQUNOLENBQUM7QUFBQyxJQUFBZ0IsUUFBQSxHQUFBQyxPQUFBLENBQUFyQixPQUFBLEdBRWFDLFdBQVciLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_jsonwebtoken","_interopRequireDefault","require","e","__esModule","default","verifyAdmin","req","res","next","token","headers","status","json","message","jwt","verify","process","env","JWT_SECRET","err","decoded","isAdmin","userId","id","_default","exports"],"sourceRoot":"/home/purple_quasar/ALX_SE/alx-webstack-portfolio-project/anchor-e-commerce-site/backend/src/middlewares/","sources":["verifyAdmin.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nconst verifyAdmin = (req, res, next) => {\n    const token = req.headers[\"authorization\"];\n    if (!token) return res.status(403).json({ message: \"No token provided\" });\n\n    jwt.verify(token, process.env.JWT_SECRET, (err, decoded) => {\n        if (err) return res.status(401).json({ message: \"Unauthorized\" });\n\n        if (!decoded.isAdmin) {\n            return res\n                .status(403)\n                .json({ message: \"Admin privileges required\" });\n        }\n\n        req.userId = decoded.id;\n        next();\n    });\n};\n\nexport default verifyAdmin;\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,WAAW,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACpC,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAAC,eAAe,CAAC;EAC1C,IAAI,CAACD,KAAK,EAAE,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAoB,CAAC,CAAC;EAEzEC,qBAAG,CAACC,MAAM,CAACN,KAAK,EAAEO,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE,CAACC,GAAG,EAAEC,OAAO,KAAK;IACxD,IAAID,GAAG,EAAE,OAAOZ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAe,CAAC,CAAC;IAEjE,IAAI,CAACO,OAAO,CAACC,OAAO,EAAE;MAClB,OAAOd,GAAG,CACLI,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA4B,CAAC,CAAC;IACvD;IAEAP,GAAG,CAACgB,MAAM,GAAGF,OAAO,CAACG,EAAE;IACvBf,IAAI,CAAC,CAAC;EACV,CAAC,CAAC;AACN,CAAC;AAAC,IAAAgB,QAAA,GAAAC,OAAA,CAAArB,OAAA,GAEaC,WAAW","ignoreList":[]}},"mtime":1737803311435}}